<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Datagram Transport Layer Security (DTLS) over Stream Control Transmission Protocol (SCTP)</title>
<meta content="Magnus Westerlund" name="author">
<meta content="John Preuß Mattsson" name="author">
<meta content="Claudio Porfiri" name="author">
<meta content="
       This document describes the usage of the Datagram Transport Layer
   Security (DTLS) protocol to protect user messages sent over the
   Stream Control Transmission Protocol (SCTP). It is an improved
   alternative to the existing RFC 6083. 
       DTLS over SCTP provides mutual authentication, confidentiality,
   integrity protection, and partial replay protection for applications
   that use SCTP as their transport protocol and allows client/server
   applications to communicate in a way that is designed to give
   communications privacy and to prevent eavesdropping and detect
   tampering or message forgery. 
       Applications using DTLS over SCTP can use almost all transport
   features provided by SCTP and its extensions. This document is an
   improved alternative to RFC 6083 and removes the 16 kbytes limitation
   on protected user message size by defining a secure user message
   fragmentation so that multiple DTLS records can be used to protect
   a single user message. It further contains a large number of
   security fixes and improvements. It updates the DTLS versions and
   SCTP-AUTH HMAC algorithms to use. It mitigates reflection attacks
   of data and control chunks and replay attacks of data chunks.  It
   simplifies secure implementation by some stricter requirements on
   the establishment procedures as well as rekeying to align with zero
   trust principles. 
    " name="description">
<meta content="xml2rfc 3.18.2" name="generator">
<meta content="draft-ietf-tsvwg-dtls-over-sctp-bis-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.18.2
    Python 3.11.6
    ConfigArgParse 1.5.3
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.3
    platformdirs 3.11.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.31.0
    setuptools 67.7.2
    six 1.16.0
    wcwidth 0.2.8
-->
<link href="draft-ietf-tsvwg-dtls-over-sctp-bis.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">DTLS over SCTP</td>
<td class="right">October 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Westerlund, et al.</td>
<td class="center">Expires 25 April 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">TSVWG</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-tsvwg-dtls-over-sctp-bis-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-10-23" class="published">23 October 2023</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-04-25">25 April 2024</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Westerlund</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">J. Preuß Mattsson</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">C. Porfiri</div>
<div class="org">Ericsson</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Datagram Transport Layer Security (DTLS) over Stream Control Transmission Protocol (SCTP)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes the usage of the Datagram Transport Layer
   Security (DTLS) protocol to protect user messages sent over the
   Stream Control Transmission Protocol (SCTP). It is an improved
   alternative to the existing RFC 6083.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">DTLS over SCTP provides mutual authentication, confidentiality,
   integrity protection, and partial replay protection for applications
   that use SCTP as their transport protocol and allows client/server
   applications to communicate in a way that is designed to give
   communications privacy and to prevent eavesdropping and detect
   tampering or message forgery.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">Applications using DTLS over SCTP can use almost all transport
   features provided by SCTP and its extensions. This document is an
   improved alternative to RFC 6083 and removes the 16 kbytes limitation
   on protected user message size by defining a secure user message
   fragmentation so that multiple DTLS records can be used to protect
   a single user message. It further contains a large number of
   security fixes and improvements. It updates the DTLS versions and
   SCTP-AUTH HMAC algorithms to use. It mitigates reflection attacks
   of data and control chunks and replay attacks of data chunks.  It
   simplifies secure implementation by some stricter requirements on
   the establishment procedures as well as rekeying to align with zero
   trust principles.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-tsvwg-dtls-over-sctp-bis/">https://datatracker.ietf.org/doc/draft-ietf-tsvwg-dtls-over-sctp-bis/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Transport Area Working Group (tsvwg) Working Group mailing list (<span><a href="mailto:tsvwg@ietf.org">mailto:tsvwg@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/tsvwg/">https://mailarchive.ietf.org/arch/browse/tsvwg/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/tsvwg/">https://www.ietf.org/mailman/listinfo/tsvwg/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/gloinul/draft-westerlund-tsvwg-dtls-over-sctp-bis">https://github.com/gloinul/draft-westerlund-tsvwg-dtls-over-sctp-bis</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 25 April 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-sctp-auth-assumptions" class="internal xref">SCTP-AUTH Assumptions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-protocol-overview" class="internal xref">Protocol Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="auto internal xref">1.4</a>.  <a href="#name-dtls-sctp-buffering-and-flo" class="internal xref">DTLS/SCTP Buffering and Flow Control</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a href="#section-1.5" class="auto internal xref">1.5</a>.  <a href="#name-comparison-with-tls-over-sc" class="internal xref">Comparison with TLS over SCTP</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.6">
                <p id="section-toc.1-1.1.2.6.1"><a href="#section-1.6" class="auto internal xref">1.6</a>.  <a href="#name-changes-from-rfc-6083" class="internal xref">Changes from RFC 6083</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.7">
                <p id="section-toc.1-1.1.2.7.1"><a href="#section-1.7" class="auto internal xref">1.7</a>.  <a href="#name-dtls-version" class="internal xref">DTLS Version</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.8">
                <p id="section-toc.1-1.1.2.8.1"><a href="#section-1.8" class="auto internal xref">1.8</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.9">
                <p id="section-toc.1-1.1.2.9.1"><a href="#section-1.9" class="auto internal xref">1.9</a>.  <a href="#name-abbreviations" class="internal xref">Abbreviations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions" class="internal xref">Conventions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-dtls-considerations" class="internal xref">DTLS Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-version-of-dtls" class="internal xref">Version of DTLS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-cipher-suites-and-cryptogra" class="internal xref">Cipher Suites and Cryptographic Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-authentication" class="internal xref">Authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-renegotiation-and-key-updat" class="internal xref">Renegotiation and Key Update</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-dtls-connection-identifier" class="internal xref">DTLS Connection Identifier</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="auto internal xref">3.6</a>.  <a href="#name-dtls-sequence-number-size" class="internal xref">DTLS Sequence number size</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="auto internal xref">3.7</a>.  <a href="#name-message-sizes" class="internal xref">Message Sizes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8">
                <p id="section-toc.1-1.3.2.8.1"><a href="#section-3.8" class="auto internal xref">3.8</a>.  <a href="#name-replay-protection" class="internal xref">Replay Protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9">
                <p id="section-toc.1-1.3.2.9.1"><a href="#section-3.9" class="auto internal xref">3.9</a>.  <a href="#name-path-mtu-discovery" class="internal xref">Path MTU Discovery</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.10">
                <p id="section-toc.1-1.3.2.10.1"><a href="#section-3.10" class="auto internal xref">3.10</a>. <a href="#name-retransmission-of-messages" class="internal xref">Retransmission of Messages</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-sctp-considerations" class="internal xref">SCTP Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-mapping-of-dtls-records" class="internal xref">Mapping of DTLS Records</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-dtls-connection-handling" class="internal xref">DTLS Connection Handling</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-payload-protocol-identifier" class="internal xref">Payload Protocol Identifier Usage</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-stream-usage" class="internal xref">Stream Usage</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-chunk-handling" class="internal xref">Chunk Handling</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-sctp-auth-hash-function" class="internal xref">SCTP-AUTH Hash Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="auto internal xref">4.7</a>.  <a href="#name-parallel-dtls-connections" class="internal xref">Parallel DTLS connections</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="auto internal xref">4.8</a>.  <a href="#name-handling-of-endpoint-pair-s" class="internal xref">Handling of Endpoint Pair Shared Secrets</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.1">
                    <p id="section-toc.1-1.4.2.8.2.1.1"><a href="#section-4.8.1" class="auto internal xref">4.8.1</a>.  <a href="#name-dtls-12-considerations" class="internal xref">DTLS 1.2 Considerations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.2">
                    <p id="section-toc.1-1.4.2.8.2.2.1"><a href="#section-4.8.2" class="auto internal xref">4.8.2</a>.  <a href="#name-dtls-13-considerations" class="internal xref">DTLS 1.3 Considerations</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.9">
                <p id="section-toc.1-1.4.2.9.1"><a href="#section-4.9" class="auto internal xref">4.9</a>.  <a href="#name-shutdown" class="internal xref">Shutdown</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.10">
                <p id="section-toc.1-1.4.2.10.1"><a href="#section-4.10" class="auto internal xref">4.10</a>. <a href="#name-transmission-limitations" class="internal xref">Transmission Limitations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.10.2.1">
                    <p id="section-toc.1-1.4.2.10.2.1.1"><a href="#section-4.10.1" class="auto internal xref">4.10.1</a>.  <a href="#name-preventing-dtls-sequence-nu" class="internal xref">Preventing DTLS sequence number wraps</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.10.2.2">
                    <p id="section-toc.1-1.4.2.10.2.2.1"><a href="#section-4.10.2" class="auto internal xref">4.10.2</a>.  <a href="#name-sctp-api-limitations" class="internal xref">SCTP API Limitations</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-dtls-sctp-control-message" class="internal xref">DTLS/SCTP Control Message</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-shutdown-request" class="internal xref">SHUTDOWN-Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-ready-to-close-indication" class="internal xref">Ready To Close Indication</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-dtls-over-sctp-service" class="internal xref">DTLS over SCTP Service</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-adaptation-layer-indication" class="internal xref">Adaptation Layer Indication in INIT/INIT ACK</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-dtls-over-sctp-initializati" class="internal xref">DTLS over SCTP Initialization</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-client-use-case" class="internal xref">Client Use Case</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-server-use-case" class="internal xref">Server Use Case</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-rfc-6083-fallback" class="internal xref">RFC 6083 Fallback</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.1">
                    <p id="section-toc.1-1.6.2.5.2.1.1"><a href="#section-6.5.1" class="auto internal xref">6.5.1</a>.  <a href="#name-client-fallback" class="internal xref">Client Fallback</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.2">
                    <p id="section-toc.1-1.6.2.5.2.2.1"><a href="#section-6.5.2" class="auto internal xref">6.5.2</a>.  <a href="#name-server-fallback" class="internal xref">Server Fallback</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.3">
                    <p id="section-toc.1-1.6.2.5.2.3.1"><a href="#section-6.5.3" class="auto internal xref">6.5.3</a>.  <a href="#name-authenticated-fallback" class="internal xref">Authenticated Fallback</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-sctp-api-consideration" class="internal xref">SCTP API Consideration</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-transport-layer-security-tl" class="internal xref">Transport Layer Security (TLS) Extensions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-tls-exporter-labels" class="internal xref">TLS Exporter Labels</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-sctp-adaptation-layer-indic" class="internal xref">SCTP Adaptation Layer Indication Code Point</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-sctp-payload-protocol-ident" class="internal xref">SCTP Payload Protocol Identifiers</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-cryptographic-consideration" class="internal xref">Cryptographic Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-downgrade-attacks" class="internal xref">Downgrade Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-targeting-dtls-messages" class="internal xref">Targeting DTLS Messages</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="auto internal xref">9.4</a>.  <a href="#name-authentication-and-policy-d" class="internal xref">Authentication and Policy Decisions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-9.5" class="auto internal xref">9.5</a>.  <a href="#name-resumption-and-tickets" class="internal xref">Resumption and Tickets</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a href="#section-9.6" class="auto internal xref">9.6</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.7">
                <p id="section-toc.1-1.9.2.7.1"><a href="#section-9.7" class="auto internal xref">9.7</a>.  <a href="#name-pervasive-monitoring" class="internal xref">Pervasive Monitoring</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.8">
                <p id="section-toc.1-1.9.2.8.1"><a href="#section-9.8" class="auto internal xref">9.8</a>.  <a href="#name-replay-attacks" class="internal xref">Replay attacks</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-motivation-for-changes" class="internal xref">Motivation for Changes</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<div id="overview">
<section id="section-1.1">
        <h3 id="name-overview">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-1.1-1">This document describes the usage of the Datagram Transport Layer
   Security (DTLS) protocol, as defined in DTLS 1.2 <span>[<a href="#RFC6347" class="cite xref">RFC6347</a>]</span>, and
   DTLS 1.3 <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>, over the Stream Control Transmission Protocol
   (SCTP), as defined in <span>[<a href="#RFC9260" class="cite xref">RFC9260</a>]</span> combined with Authenticated
   Chunks for SCTP (SCTP-AUTH) <span>[<a href="#RFC4895" class="cite xref">RFC4895</a>]</span>.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Once the SCTP-AUTH assumptions are fulfilled (see <a href="#Assumptions" class="auto internal xref">Section 1.2</a>),
   this specification provides mutual authentication of endpoints,
   data confidentiality, data origin authentication, data integrity
   protection, and a certain level of data replay protection of user
   messages for applications that use SCTP as their transport protocol
   (see in this regard what stated in <a href="#replay_issues" class="auto internal xref">Section 9.8</a>). Thus, it
   allows client/server applications to communicate in a way that is
   designed to give communications privacy and to prevent
   eavesdropping and detect tampering or message forgery. DTLS/SCTP
   uses DTLS for mutual authentication, key exchange with forward
   secrecy for SCTP-AUTH, and confidentiality of user
   messages. DTLS/SCTP use SCTP and SCTP-AUTH for integrity protection
   and partial replay protection of all SCTP Chunks that can be
   authenticated, including user messages.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">Applications using DTLS over SCTP can use almost all transport
   features provided by SCTP and its extensions. DTLS/SCTP supports:<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-4.1">
            <p id="section-1.1-4.1.1">preservation of message boundaries.<a href="#section-1.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-4.2">
            <p id="section-1.1-4.2.1">a large number of unidirectional and bidirectional streams.<a href="#section-1.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-4.3">
            <p id="section-1.1-4.3.1">ordered and unordered delivery of SCTP user messages.<a href="#section-1.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-4.4">
            <p id="section-1.1-4.4.1">the partial reliability extension as defined in <span>[<a href="#RFC3758" class="cite xref">RFC3758</a>]</span>.<a href="#section-1.1-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-4.5">
            <p id="section-1.1-4.5.1">the dynamic address reconfiguration extension as defined in
 <span>[<a href="#RFC5061" class="cite xref">RFC5061</a>]</span>.<a href="#section-1.1-4.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-4.6">
            <p id="section-1.1-4.6.1">User messages of any size.<a href="#section-1.1-4.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.1-5">The method described in this document requires that the SCTP
   implementation supports the optional feature of fragmentation of
   SCTP user messages as defined in <span>[<a href="#RFC9260" class="cite xref">RFC9260</a>]</span>. The implementation is
   required to have an SCTP API (for example the one described in
   <span>[<a href="#RFC6458" class="cite xref">RFC6458</a>]</span>) that supports partial user message delivery and also
   recommended that I-DATA chunks as defined in <span>[<a href="#RFC8260" class="cite xref">RFC8260</a>]</span> is used to
   efficiently implement and support larger user messages.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
<p id="section-1.1-6">To simplify implementation and reduce the risk for security holes,
   limitations have been defined such that STARTTLS as specified in
   <span>[<a href="#RFC3788" class="cite xref">RFC3788</a>]</span> is no longer supported.<a href="#section-1.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Assumptions">
<section id="section-1.2">
        <h3 id="name-sctp-auth-assumptions">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-sctp-auth-assumptions" class="section-name selfRef">SCTP-AUTH Assumptions</a>
        </h3>
<p id="section-1.2-1">In this document it is assumed that SCTP-AUTH is provided with
periodic rekeying by periodic usage the mechanism for DTLS rekeying
and re-authentication defined in this document.  It is also assumed
that SCTP-AUTH specification <span>[<a href="#RFC4895" class="cite xref">RFC4895</a>]</span> has been updated to address
most of the known issues.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">SCTP-AUTH as defined by RFC4895 has been identified as weak in the
following parts:<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.2-3">
<li id="section-1.2-3.1">
            <p id="section-1.2-3.1.1">Reflection of authenticated data chunks<a href="#section-1.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-3.2">
            <p id="section-1.2-3.2.1">Replay of authenticated data chunks<a href="#section-1.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-3.3">
            <p id="section-1.2-3.3.1">Single key used with different HMAC algorithms<a href="#section-1.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-3.4">
            <p id="section-1.2-3.4.1">Reflection of authenticated control chunks<a href="#section-1.2-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-3.5">
            <p id="section-1.2-3.5.1">Replay of authenticated control chunks<a href="#section-1.2-3.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-1.2-4">We are expecting the SCTP-AUTH update to fully address issue 1, 3 and
4. Issue 2 will be partially addressed in this specification through
periodic rekeying to prevent replay to inject data and affect
availability, but that is based on SCTP implementation correctly
handling replayed or duplicated packets. SCTP-AUTH issues mitigated
and having a periodic rekeying is a condicio sine qua non
(indispensable condition) for this document to provide a working
solution.<a href="#section-1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol-overview">
<section id="section-1.3">
        <h3 id="name-protocol-overview">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
        </h3>
<p id="section-1.3-1">The DTLS/SCTP protection is defined as an SCTP adaptation layer
<span>[<a href="#RFC5061" class="cite xref">RFC5061</a>]</span> that is implemented on top of an SCTP API for an SCTP
implementation with SCTP-AUTH <span>[<a href="#RFC4895" class="cite xref">RFC4895</a>]</span> support. DTLS/SCTP is
expected to provide an SCTP like API towards the upper layer protocol
with some additions for controlling the DTLS/SCTP security parameters
and policies. This minimizes the impact on the SCTP implementation and
wire image.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<span id="name-dtls-sctp-layering-in-regar"></span><div id="dtls-sctp-layering">
<figure id="figure-1">
          <div id="section-1.3-2.1">
            <div class="alignLeft art-svg artwork" id="section-1.3-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="288" width="464" viewBox="0 0 464 288" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,256" fill="none" stroke="black"></path>
                <path d="M 184,32 L 184,256" fill="none" stroke="black"></path>
                <path d="M 272,128 L 272,160" fill="none" stroke="black"></path>
                <path d="M 328,128 L 328,160" fill="none" stroke="black"></path>
                <path d="M 8,32 L 184,32" fill="none" stroke="black"></path>
                <path d="M 8,96 L 184,96" fill="none" stroke="black"></path>
                <path d="M 272,128 L 328,128" fill="none" stroke="black"></path>
                <path d="M 184,144 L 264,144" fill="none" stroke="black"></path>
                <path d="M 272,160 L 328,160" fill="none" stroke="black"></path>
                <path d="M 8,192 L 184,192" fill="none" stroke="black"></path>
                <path d="M 8,256 L 184,256" fill="none" stroke="black"></path>
                <g class="text">
                  <text x="96" y="68">ULP</text>
                  <text x="204" y="100">&lt;-</text>
                  <text x="236" y="100">SCTP</text>
                  <text x="272" y="100">API</text>
                  <text x="296" y="100">+</text>
                  <text x="340" y="100">Security</text>
                  <text x="420" y="100">Parameters</text>
                  <text x="56" y="132">DTLS/SCTP</text>
                  <text x="60" y="148">Adaptation</text>
                  <text x="300" y="148">DTLS</text>
                  <text x="40" y="164">Layer</text>
                  <text x="204" y="196">&lt;-</text>
                  <text x="236" y="196">SCTP</text>
                  <text x="272" y="196">API</text>
                  <text x="296" y="196">+</text>
                  <text x="344" y="196">SCTP-AUTH</text>
                  <text x="400" y="196">API</text>
                  <text x="44" y="228">SCTP</text>
                  <text x="72" y="228">+</text>
                  <text x="120" y="228">SCTP-AUTH</text>
                </g>
              </svg><a href="#section-1.3-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-dtls-sctp-layering-in-regar" class="selfRef">DTLS/SCTP layering in regard to SCTP and upper layer protocol</a>
          </figcaption></figure>
</div>
<p id="section-1.3-3">DTLS/SCTP performs protection operations on ULP data as it is provided
to DTLS/SCTP, as whole or a part of a SCTP user messages to be
transported to the peer. DTLS/SCTP uses the regular SCTP multiplexing
mechanisms for data using streams and individual user messages. The
protection operation for a ULP user message larger than the maximum
DTLS record size is performed by first splitting the user message into
suitable fragments that fit into individual DTLS records. Each
fragment is encrypted and provided with authentication tag by DTLS.<a href="#section-1.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-1.3-4">
<pre>
   m0 | m1 | m2 | ... = user_message

  user_message' = DTLS( m0 ) | DTLS( m1 ) | DTLS( m2 ) ...
</pre><a href="#section-1.3-4" class="pilcrow">¶</a>
</div>
<p id="section-1.3-5">The sequence of protected user message fragments (user_message') are
then transmitted as a SCTP user message. SCTP-AUTH provides
authentication of the SCTP packets and prevents injection of data or
reordering of DTLS fragments thus ensuring that each protected user
message can be de-protected in the receiver in order and
reassembled. Partial transmission and delivery of user messages are
supported on a per fragment basis.<a href="#section-1.3-5" class="pilcrow">¶</a></p>
<p id="section-1.3-6">SCTP's capability for multi-stream concurrent transmission of
different SCTP user messages, where each SCTP user message can
potentially be very large, results in some challenges for any change
of the keys used to protect the ULP data. SCTP-AUTH API, defined in
<span>[<a href="#RFC6458" class="cite xref">RFC6458</a>]</span>, provides additional limitations that needs to be
considered when supported. These issues and the related limitations
will be discussed more in details below.<a href="#section-1.3-6" class="pilcrow">¶</a></p>
<p id="section-1.3-7">RFC6083 dealt with the above limitations by requiring that the peers
drained all outstanding data before updating the key to prevent
issues. This can have significant impact on a ULP that requires timely
and frequent exchange of user messages. This specification uses
another solution to these problems assuming a sufficient capable SCTP
and SCTP-AUTH implementations and with rich enough APIs.<a href="#section-1.3-7" class="pilcrow">¶</a></p>
<p id="section-1.3-8">The solution that ensures the current keying material will not be
prematurely discarded on renegotiation or key update, is based on not
using these mechanisms and instead establishing a second DTLS
connection over the SCTP association. This creates a parallel DTLS
connections, where the DTLS connection ID feature is used to identify
the originating DTLS connection for each DTLS record or message. When
a new DTLS connection has been established and its keying material is
made available, the sender starts using it to protect the ULP
data. When all protected user message fragments protected by the old
key have been delivered in a non-renegable way then the old DTLS
connection can be terminated and the associated keying material
discarded.<a href="#section-1.3-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="buffering">
<section id="section-1.4">
        <h3 id="name-dtls-sctp-buffering-and-flo">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-dtls-sctp-buffering-and-flo" class="section-name selfRef">DTLS/SCTP Buffering and Flow Control</a>
        </h3>
<p id="section-1.4-1">With DTLS/SCTP as a layer above SCTP stacks on both sender and
   receiver side some consideration is needed for buffering and
   resource contention, and how back pressure is applied in cases the
   receiving application is not keeping up with the sender. The ULP
   may use multiple user messages simultaneous, and the progress and
   delivery of these messages are progressing independently, thus the
   receiving DTLS/SCTP implementation may not receive DTLS records in
   order in case of packet loss.<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<p id="section-1.4-2">On the sender side the DTLS/SCTP layer will need to accept data
   from the ULP of at least one maximum DTLS record size. The maximum
   DTLS record size is 2<sup>14</sup> bytes per default or a lower
   negotiated value using the DTLS extension defined in
   <span>[<a href="#RFC8449" class="cite xref">RFC8449</a>]</span>. The user message fragment is then protected by DTLS
   and assumed to immediately after be dispatched for transmission by
   SCTP.<a href="#section-1.4-2" class="pilcrow">¶</a></p>
<p id="section-1.4-3">As SCTP schedules the DTLS record for transmission as SCTP packets
   it will become part of the data tracked by the send/receive buffer
   in the SCTP stacks. The maximum receiver buffer size is negotiated
   and provides an upper limit of how much outstanding data can exist
   on the SCTP layer. For example, if an DTLS record part of user
   message N experience repeated packet losses, it may not be
   delivered, despite several later user messages fragments has been
   delivered.<a href="#section-1.4-3" class="pilcrow">¶</a></p>
<p id="section-1.4-4">Next, we assume that the receiver side DTLS/SCTP will read partial
   user messages from the SCTP receiver stack as they become available
   unless it can't keep up or has run out of intermediate buffer space
   for reassembly of the DTLS records in each user message. Thus, in
   case the receiver falls behind it will eventually block the
   receiver buffer by not consuming data from it and thus creating
   back pressure towards the sender. But, at any time it is assumed
   that the receiver side DTLS/SCTP layer will not buffer multiple
   DTLS records, and instead process each as soon as
   possible. Buffering multiple DTLS records prior to DTLS decryption
   would increase the total number of DTLS records in flight, counted
   between DTLS encryption and decryption, and thus risk overlapping
   DTLS sequence numbers.<a href="#section-1.4-4" class="pilcrow">¶</a></p>
<p id="section-1.4-5">To avoid overlapping sequence number the DTLS sender should first
   of all use 16-bit sequence number to enable a larger
   space. Secondly, it should track which DTLS records has been
   non-renegable ACKed by the receiver and always maintain a certain
   safety buffer in number of DTLS records. Thirdly, the
   implementation needs to attempt to minimize usage of buffers that
   exist after the DTLS encryption until the DTLS Decryption in its
   sender and receiver implementation.<a href="#section-1.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="comparison-with-tls-over-sctp">
<section id="section-1.5">
        <h3 id="name-comparison-with-tls-over-sc">
<a href="#section-1.5" class="section-number selfRef">1.5. </a><a href="#name-comparison-with-tls-over-sc" class="section-name selfRef">Comparison with TLS over SCTP</a>
        </h3>
<p id="section-1.5-1">TLS, from which DTLS was derived, is designed to run on top of a
   byte-stream-oriented transport protocol providing a reliable, in-
   sequence delivery. TLS over SCTP as described in <span>[<a href="#RFC3436" class="cite xref">RFC3436</a>]</span> has
   some serious limitations:<a href="#section-1.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5-2.1">
            <p id="section-1.5-2.1.1">It does not support the unordered delivery of SCTP user messages.<a href="#section-1.5-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.5-2.2">
            <p id="section-1.5-2.2.1">It does not support partial reliability as defined in
<span>[<a href="#RFC3758" class="cite xref">RFC3758</a>]</span>.<a href="#section-1.5-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.5-2.3">
            <p id="section-1.5-2.3.1">It only supports the usage of the same number of streams in both
 directions.<a href="#section-1.5-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.5-2.4">
            <p id="section-1.5-2.4.1">It uses a TLS connection for every bidirectional stream, which
 requires a substantial amount of resources and message exchanges
 if a large number of streams is used.<a href="#section-1.5-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="changes-from-rfc-6083">
<section id="section-1.6">
        <h3 id="name-changes-from-rfc-6083">
<a href="#section-1.6" class="section-number selfRef">1.6. </a><a href="#name-changes-from-rfc-6083" class="section-name selfRef">Changes from RFC 6083</a>
        </h3>
<p id="section-1.6-1">The DTLS over SCTP solution defined in RFC 6083 had the following
   limitations:<a href="#section-1.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6-2.1">
            <p id="section-1.6-2.1.1">The maximum user message size is 2<sup>14</sup> (16384) bytes,
 which is a single DTLS record limit.<a href="#section-1.6-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.6-2.2">
            <p id="section-1.6-2.2.1">DTLS 1.0 has been deprecated for RFC 6083 requiring at least DTLS
1.2 <span>[<a href="#RFC8996" class="cite xref">RFC8996</a>]</span>. This creates additional limitations as discussed
in <a href="#DTLS-version" class="auto internal xref">Section 1.7</a>.<a href="#section-1.6-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.6-2.3">
            <p id="section-1.6-2.3.1">DTLS messages that don't contain protected user message data
where limited to only be sent on Stream 0, which could
potentially impact applications.<a href="#section-1.6-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.6-2.4">
            <p id="section-1.6-2.4.1">An on-path attacker can reflect the authenticated part of a SCTP
packet back to the sender as well as replaying data and control
chunks.<a href="#section-1.6-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.6-3">This specification defines the following changes compared with RFC
   6083:<a href="#section-1.6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6-4.1">
            <p id="section-1.6-4.1.1">Removes the limitations on user messages sizes by defining a secure
fragmentation mechanism. It is optional to support message sizes
over 2<sup>64</sup>-1 bytes.<a href="#section-1.6-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.6-4.2">
            <p id="section-1.6-4.2.1">Update DTLS key material without requiring draining all in-flight
user message from SCTP.<a href="#section-1.6-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.6-4.3">
            <p id="section-1.6-4.3.1">Mandates that more modern DTLS version are used (DTLS 1.2 or
1.3)<a href="#section-1.6-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.6-4.4">
            <p id="section-1.6-4.4.1">Mandates support of stronger HMAC algorithm (SHA-256) in the SCTP
authentication extension <span>[<a href="#RFC4895" class="cite xref">RFC4895</a>]</span>.<a href="#section-1.6-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.6-4.5">
            <p id="section-1.6-4.5.1">Recommends support of <span>[<a href="#RFC8260" class="cite xref">RFC8260</a>]</span> to enable interleaving of large
SCTP user messages to avoid scheduling issues.<a href="#section-1.6-4.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.6-4.6">
            <p id="section-1.6-4.6.1">Applies stricter requirements on always using DTLS for all user
messages in the SCTP association.<a href="#section-1.6-4.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.6-4.7">
            <p id="section-1.6-4.7.1">Requires that SCTP-AUTH is applied to all SCTP Chunks that can be
authenticated.<a href="#section-1.6-4.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.6-4.8">
            <p id="section-1.6-4.8.1">Requires support of partial delivery of user messages.<a href="#section-1.6-4.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.6-4.9">
            <p id="section-1.6-4.9.1">Requires an updates SCTP-AUTH specification to mitigate packet
reflection attacks that can impact the SCTP association
availability.<a href="#section-1.6-4.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.6-4.10">
            <p id="section-1.6-4.10.1">Mandates SCTP-AUTH rekeying before the TSN cycles back to the
Initial TSN to mitigate replay of data chunks.<a href="#section-1.6-4.10.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="DTLS-version">
<section id="section-1.7">
        <h3 id="name-dtls-version">
<a href="#section-1.7" class="section-number selfRef">1.7. </a><a href="#name-dtls-version" class="section-name selfRef">DTLS Version</a>
        </h3>
<p id="section-1.7-1">Using DTLS 1.2 instead of using DTLS 1.0 limits the lifetime of a
   DTLS connection and the data volume which can be transferred over a
   DTLS connection.  This is caused by:<a href="#section-1.7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.7-2.1">
            <p id="section-1.7-2.1.1">The number of renegotiations in DTLS 1.2 is limited to 65534
compared to unlimited in DTLS 1.0.<a href="#section-1.7-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.7-2.2">
            <p id="section-1.7-2.2.1">While the AEAD limits in DTLS 1.3 does not formally apply to DTLS
1.2 the mathematical limits apply equally well to DTLS 1.2.<a href="#section-1.7-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.7-3">DTLS 1.3 comes with a large number of significant changes.<a href="#section-1.7-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.7-4.1">
            <p id="section-1.7-4.1.1">Renegotiations are not supported and instead partly replaced by
 key updates. The number of key updates is limited to
 2<sup>48</sup>.<a href="#section-1.7-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.7-4.2">
            <p id="section-1.7-4.2.1">Strict AEAD significantly limits on how many DTLS records can be
 sent before rekeying.<a href="#section-1.7-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.7-5">Many applications using DTLS/SCTP are of semi-permanent nature.
   Semi-permanent term comes from telecom and referres to connections
   that start at a certain time and are rarely closed.
   Semi-permanent connections use SCTP associations with expected
   lifetimes of months or even years where there is a significant
   cost for bringing them down in order to restart it.
   Such DTLS/SCTP usages that need:<a href="#section-1.7-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.7-6.1">
            <p id="section-1.7-6.1.1">Periodic re-authentication and transfer of revocation information
of both endpoints (not only the DTLS client).<a href="#section-1.7-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.7-6.2">
            <p id="section-1.7-6.2.1">Periodic rerunning of Diffie-Hellman Key Exchange to provide
forward secrecy and mitigate static key exfiltration attacks.<a href="#section-1.7-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.7-6.3">
            <p id="section-1.7-6.3.1">Perform SCTP-AUTH rekeying.<a href="#section-1.7-6.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.7-7">At the time of publication, DTLS 1.3 does not support any of these,
   where DTLS 1.2 renegotiation functionality can provide these
   functionality in the context of DTLS/SCTP. To address these
   requirements from semi-permanent applications, this document uses
   several overlapping DTLS connections with either DTLS 1.2 or
   1.3. Having uniform procedures reduces the impact when upgrading
   from DTLS 1.2 to DTLS 1.3 and avoids using the renegotiation
   mechanism which is disabled by default in many DTLS
   implementations.<a href="#section-1.7-7" class="pilcrow">¶</a></p>
<p id="section-1.7-8">To address known vulnerabilities in DTLS 1.2 this document
   describes and mandates implementation constraints on ciphers and
   protocol options. The DTLS 1.2 renegotiation mechanism is forbidden
   to be used as it creates the need for additional mechanism to handle
   race conditions and interactions between using DTLS connections in
   parallel.<a href="#section-1.7-8" class="pilcrow">¶</a></p>
<p id="section-1.7-9">Secure negotiation of the DTLS version is handled by the DTLS
   handshake. If the endpoints do not support a common DTLS version
   the DTLS handshake will be aborted.<a href="#section-1.7-9" class="pilcrow">¶</a></p>
<p id="section-1.7-10">In the rest of the document, unless the version of DTLS is
   specifically called out, the text applies to both versions of DTLS.<a href="#section-1.7-10" class="pilcrow">¶</a></p>
<p id="section-1.7-11">DTLS/SCTP requires the maximum DTLS record size to be known, and
   not being changed during the lifetime of the Association.<a href="#section-1.7-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-1.8">
        <h3 id="name-terminology">
<a href="#section-1.8" class="section-number selfRef">1.8. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.8-1">This document uses the following terms:<a href="#section-1.8-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.8-2">
          <dt id="section-1.8-2.1">Association:</dt>
          <dd style="margin-left: 1.5em" id="section-1.8-2.2">
            <p id="section-1.8-2.2.1">An SCTP association.<a href="#section-1.8-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.8-2.3">Connection:</dt>
          <dd style="margin-left: 1.5em" id="section-1.8-2.4">
            <p id="section-1.8-2.4.1">A DTLS connection. It is uniquely identified by a
   connection identifier.<a href="#section-1.8-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.8-2.5">Stream:</dt>
          <dd style="margin-left: 1.5em" id="section-1.8-2.6">
            <p id="section-1.8-2.6.1">A unidirectional stream of an SCTP association.  It is
   uniquely identified by a stream identifier.<a href="#section-1.8-2.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="abbreviations">
<section id="section-1.9">
        <h3 id="name-abbreviations">
<a href="#section-1.9" class="section-number selfRef">1.9. </a><a href="#name-abbreviations" class="section-name selfRef">Abbreviations</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-1.9-1">
          <dt id="section-1.9-1.1">AEAD:</dt>
          <dd style="margin-left: 1.5em" id="section-1.9-1.2">
            <p id="section-1.9-1.2.1">Authenticated Encryption with Associated Data<a href="#section-1.9-1.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.9-1.3">DTLS:</dt>
          <dd style="margin-left: 1.5em" id="section-1.9-1.4">
            <p id="section-1.9-1.4.1">Datagram Transport Layer Security<a href="#section-1.9-1.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.9-1.5">HMAC:</dt>
          <dd style="margin-left: 1.5em" id="section-1.9-1.6">
            <p id="section-1.9-1.6.1">Keyed-Hash Message Authentication Code<a href="#section-1.9-1.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.9-1.7">MTU:</dt>
          <dd style="margin-left: 1.5em" id="section-1.9-1.8">
            <p id="section-1.9-1.8.1">Maximum Transmission Unit<a href="#section-1.9-1.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.9-1.9">PPID:</dt>
          <dd style="margin-left: 1.5em" id="section-1.9-1.10">
            <p id="section-1.9-1.10.1">Payload Protocol Identifier<a href="#section-1.9-1.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.9-1.11">SCTP:</dt>
          <dd style="margin-left: 1.5em" id="section-1.9-1.12">
            <p id="section-1.9-1.12.1">Stream Control Transmission Protocol<a href="#section-1.9-1.12.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.9-1.13">SCTP-AUTH:</dt>
          <dd style="margin-left: 1.5em" id="section-1.9-1.14">
            <p id="section-1.9-1.14.1">Authenticated Chunks for SCTP <span>[<a href="#RFC4895" class="cite xref">RFC4895</a>]</span><a href="#section-1.9-1.14.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.9-1.15">TCP:</dt>
          <dd style="margin-left: 1.5em" id="section-1.9-1.16">
            <p id="section-1.9-1.16.1">Transmission Control Protocol<a href="#section-1.9-1.16.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.9-1.17">TLS:</dt>
          <dd style="margin-left: 1.5em" id="section-1.9-1.18">
            <p id="section-1.9-1.18.1">Transport Layer Security<a href="#section-1.9-1.18.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.9-1.19">ULP:</dt>
          <dd style="margin-left: 1.5em" id="section-1.9-1.20">
            <p id="section-1.9-1.20.1">Upper Layer Protocol<a href="#section-1.9-1.20.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="conventions">
<section id="section-2">
      <h2 id="name-conventions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions" class="section-name selfRef">Conventions</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all
   capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dtls-considerations">
<section id="section-3">
      <h2 id="name-dtls-considerations">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-dtls-considerations" class="section-name selfRef">DTLS Considerations</a>
      </h2>
<div id="version-of-dtls">
<section id="section-3.1">
        <h3 id="name-version-of-dtls">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-version-of-dtls" class="section-name selfRef">Version of DTLS</a>
        </h3>
<p id="section-3.1-1">This document defines the usage of either DTLS 1.3 <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>, or
   DTLS 1.2 <span>[<a href="#RFC6347" class="cite xref">RFC6347</a>]</span>.  Earlier versions of DTLS MUST NOT be used
   (see <span>[<a href="#RFC8996" class="cite xref">RFC8996</a>]</span>).  DTLS 1.3 is RECOMMENDED for security and
   performance reasons.  It is expected that DTLS/SCTP as described in
   this document will work with future versions of DTLS.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">Only one version of DTLS MUST be used during the lifetime of an
   SCTP Association, meaning that the procedure for replacing the DTLS
   version in use requires the existing SCTP Association to be
   terminated and a new SCTP Association with the desired DTLS version
   to be instantiated.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cipher-suites-and-cryptographic-parameters">
<section id="section-3.2">
        <h3 id="name-cipher-suites-and-cryptogra">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-cipher-suites-and-cryptogra" class="section-name selfRef">Cipher Suites and Cryptographic Parameters</a>
        </h3>
<p id="section-3.2-1">For DTLS 1.2, the cipher suites forbidden by <span>[<a href="#RFC9113" class="cite xref">RFC9113</a>]</span> MUST NOT
   be used. For all versions of DTLS, cryptographic parameters giving
   confidentiality and forward secrecy MUST be used.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">There are potential for aligning used hash algorithms between
   SCTP-AUTH and the DTLS cipher suit. If the otherwise considered to
   be used SCTP-AUTH hash algorithms and DTLS Cipher suits have
   matching hashing algorithms it is RECOMMENDED to indicate a
   preference for such algorithms. Note, however as the SCTP-AUTH
   hashing algorithm is chosen during SCTP association handshake it
   can't be changed once it is known what is supported in DTLS by the
   peer endpoint.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication">
<section id="section-3.3">
        <h3 id="name-authentication">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-authentication" class="section-name selfRef">Authentication</a>
        </h3>
<p id="section-3.3-1">The DTLS handshakes MUST use mutual authentication.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="renegotiation-and-key-update">
<section id="section-3.4">
        <h3 id="name-renegotiation-and-key-updat">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-renegotiation-and-key-updat" class="section-name selfRef">Renegotiation and Key Update</a>
        </h3>
<p id="section-3.4-1">DTLS 1.2 renegotiation enables rekeying (with ephemeral Diffie-
   Hellman) of DTLS as well as mutual reauthentication and transfer of
   revocation information inside an DTLS 1.2 connection. Renegotiation
   has been removed from DTLS 1.3 and partly replaced with
   post-handshake mechanism for key update. The parallel DTLS
   connection solution was specified due to lack of necessary features
   with DTLS 1.3 considered needed for long lived SCTP associations,
   such as rekeying (with ephemeral Diffie-Hellman) as well as mutual
   reauthentication.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">This specification does not allow usage of DTLS 1.2 renegotiation to
   avoid race conditions and corner cases in the interaction between
   the parallel DTLS connection mechanism and the keying of
   SCTP-AUTH. In addition, renegotiation is also disabled in some
   implementations, as well as dealing with the epoch change reliable
   have similar or worse application impact.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4-3">This specification also forbids against using DTLS 1.3 key update
   and instead rely on parallel DTLS connections. For DTLS 1.3 there
   isn't feature parity. It also has the issue that a DTLS
   implementation following the RFC may assume a too limited window
   for SCTP where the previous epoch's security context is maintained
   and thus, changes to epoch handling would be necessary.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4">A DTLS 1.2 endpoint MUST NOT use renegotiation and a DTLS 1.3
   endpoint MUST NOT send any KeyUpdate message. The endpoint MUST
   instead initiate a new DTLS connection before the old one reaches
   the used cipher suit's key lifetime. The AEAD limits given in
   section 4.5.3 of <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span> SHOULD be followed.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dtls-connection-identifier">
<section id="section-3.5">
        <h3 id="name-dtls-connection-identifier">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-dtls-connection-identifier" class="section-name selfRef">DTLS Connection Identifier</a>
        </h3>
<p id="section-3.5-1">The DTLS Connection ID MUST be negotiated, according to <span>[<a href="#RFC9146" class="cite xref">RFC9146</a>]</span>
   for DTLS 1.2, and Section 9 of <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span> for DTLS 1.3.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">Section 4 of <span>[<a href="#RFC9146" class="cite xref">RFC9146</a>]</span> states "If, however, an implementation
   chooses to receive different lengths of CID, the assigned CID
   values must be self-delineating since there is no other mechanism
   available to determine what connection (and thus, what CID length)
   is in use.". As this solution requires multiple connection IDs,
   using a zero-length CID will be highly problematic as it could
   result in that any DTLS records with a zero length CID ends up in
   another DTLS connection context, and there fail the decryption and
   integrity verification. And in that case to avoid losing the DTLS
   record, it would have to be forwarded to another zero-length CID
   using DTLS Connection, where decryption and validation must be
   tried, resulting in higher resource utilization. Thus, it is
   REQUIRED to use non-zero length CID values, and RECOMMENDED to use
   a single common length for the CID values. A single byte should be
   sufficient, as reuse of old CIDs is possible as long as the
   implementation ensures that they are not used in near time to the
   previous usage.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dtls-sequence-number-size">
<section id="section-3.6">
        <h3 id="name-dtls-sequence-number-size">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-dtls-sequence-number-size" class="section-name selfRef">DTLS Sequence number size</a>
        </h3>
<p id="section-3.6-1">16-bit sequence number SHOULD be used rather than 8-bit to avoid
   limitations in number of inflight DTLS records. Overlapping
   sequence number due to wrapping of the sequence number MUST be
   prevented as it otherwise can lead to decryption failure that
   result in failure of the transport service. See
   <a href="#Prevent-DTLS-Seq-wraps" class="auto internal xref">Section 4.10.1</a> for how to prevent sequence number
   wraps.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Msg-size">
<section id="section-3.7">
        <h3 id="name-message-sizes">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-message-sizes" class="section-name selfRef">Message Sizes</a>
        </h3>
<p id="section-3.7-1">If DTLS 1.3 is used, the length field in the record layer MUST
   be included in all records.<a href="#section-3.7-1" class="pilcrow">¶</a></p>
<p id="section-3.7-2">DTLS/SCTP, automatically fragments and reassembles user
   messages. This specification defines how to fragment the user
   messages into DTLS records, where each DTLS record allows a maximum
   of 2<sup>14</sup> protected bytes. It is mandated that DTLS
   supports the maximum record size of 2<sup>14</sup> bytes.
   DTLS/SCTP MAY exploit maximum DTLS record size less than
   2<sup>14</sup> bytes due to implementation choice, in such case
   maximum record size MUST be negotiated according to
   <span>[<a href="#RFC8449" class="cite xref">RFC8449</a>]</span>. The negotiated value MUST be known to DTLS/SCTP and
   SHALL NOT be changed during the SCTP Association lifetime.<a href="#section-3.7-2" class="pilcrow">¶</a></p>
<p id="section-3.7-3">The sequence of DTLS records is then fragmented into DATA or I-DATA
   Chunks to fit the path MTU by SCTP. These changes ensure that
   DTLS/SCTP has the same capability as SCTP to support user messages
   of any size. However, to simplify implementations it is OPTIONAL to
   support user messages larger than 2<sup>64</sup>-1 bytes. This is
   to allow implementation to assume that 64-bit length fields and
   offset pointers will be sufficient.<a href="#section-3.7-3" class="pilcrow">¶</a></p>
<p id="section-3.7-4">The security operations and reassembly process requires that the
   protected user message, i.e., with DTLS record overhead, is stored
   in the receiver's buffer. This buffer space will thus put a limit
   on the largest size of plain text user message that can be
   transferred securely. However, by mandating the use of the partial
   delivery of user messages from SCTP and assuming that no two
   messages received on the same stream are interleaved (as it is the
   case when using the API defined in <span>[<a href="#RFC6458" class="cite xref">RFC6458</a>]</span>) the minimally
   required buffering prior to DTLS processing is a single DTLS record
   per used incoming stream. This enables the DTLS/SCTP implementation
   to provide the Upper Layer Protocol (ULP) with each DTLS record's
   content, when it has been decrypted and its integrity been
   verified, enabling partial user message delivery to the ULP.
   However, for efficient operation and avoiding flow control stalls
   if user message fragments are not frequently and expediently moved
   to upper layer memory buffers, the receiver buffer needs to be
   larger.<a href="#section-3.7-4" class="pilcrow">¶</a></p>
<p id="section-3.7-5">Implementations can trade-off buffer memory requirements in the
   DTLS layer with transport overhead by using smaller DTLS records,
   in this case the record size limit extension for DTLS according to
   <span>[<a href="#RFC8449" class="cite xref">RFC8449</a>]</span> MUST be used and the negotiated record size SHALL be
   communicated to DTLS/SCTP.  The maximum record size SHALL be the
   same during the lifetime of the Association, i.e., renegotiated to
   the same value in all subsequent DTLS connections.<a href="#section-3.7-5" class="pilcrow">¶</a></p>
<p id="section-3.7-6">The DTLS/SCTP implementation is expected to behave very similar to
   just SCTP when it comes to handling of user messages and dealing
   with large user messages and their reassembly and
   processing. Making it the ULP responsible for handling any resource
   contention related to large user messages.<a href="#section-3.7-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="replay_protection">
<section id="section-3.8">
        <h3 id="name-replay-protection">
<a href="#section-3.8" class="section-number selfRef">3.8. </a><a href="#name-replay-protection" class="section-name selfRef">Replay Protection</a>
        </h3>
<p id="section-3.8-1">SCTP-AUTH <span>[<a href="#RFC4895" class="cite xref">RFC4895</a>]</span> does not have explicit replay
   protection. However, the combination of SCTP-AUTH's protection of
   DATA or I-DATA chunks and SCTP user message handling will prevent
   third party attempts to inject or replay SCTP data chunks as long as
   the Transmission Sequence Numbers (TSNs) are unique. In fact, this
   document's solution is dependent on SCTP-AUTH and SCTP to prevent
   reordering, duplication, and removal of the DTLS records within
   each protected user message.  This includes detection of changes to
   what DTLS records start and end the SCTP user message, and removal of
   DTLS records before an increment to the epoch.  Without SCTP-AUTH,
   these would all have required explicit handling.<a href="#section-3.8-1" class="pilcrow">¶</a></p>
<p id="section-3.8-2">To prevent replay of DATA or I-DATA chunks resulting in impact on
   the received protected user message, the SCTP-AUTH key MUST be
   retired before it has been used with more than 2<sup>32</sup> TSNs.
   Implementations MUST therefore setup a new parallel DTLS connection
   to rekey well before 2<sup>32</sup> TSNs have been used with a
   SCTP-AUTH key.<a href="#section-3.8-2" class="pilcrow">¶</a></p>
<p id="section-3.8-3">DTLS/SCTP does not provide replay protection for authenticated
   control chunks such as ERROR, RE-CONFIG <span>[<a href="#RFC6525" class="cite xref">RFC6525</a>]</span>, or SACK. An
   on-path attacker can replay control chunks as long as the receiving
   endpoint still has the endpoint pair shared secret. Such replay
   could disrupt the SCTP association and could therefore be a
   denial-of-service attack.<a href="#section-3.8-3" class="pilcrow">¶</a></p>
<p id="section-3.8-4">DTLS optionally supports record replay detection. Such replay
   detection could result in the DTLS layer dropping valid messages
   received outside of the DTLS replay window. As DTLS/SCTP provides
   the necessary replay protection even without DTLS replay
   protection, the replay detection of DTLS MUST NOT be used.<a href="#section-3.8-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="path-mtu-discovery">
<section id="section-3.9">
        <h3 id="name-path-mtu-discovery">
<a href="#section-3.9" class="section-number selfRef">3.9. </a><a href="#name-path-mtu-discovery" class="section-name selfRef">Path MTU Discovery</a>
        </h3>
<p id="section-3.9-1">DTLS Path MTU Discovery MUST NOT be used.  Since SCTP provides Path
   MTU discovery and fragmentation/reassembly for user messages as
   specified in <a href="#Msg-size" class="auto internal xref">Section 3.7</a>, DTLS can send maximum sized DTLS
   Records.<a href="#section-3.9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="retransmission-of-messages">
<section id="section-3.10">
        <h3 id="name-retransmission-of-messages">
<a href="#section-3.10" class="section-number selfRef">3.10. </a><a href="#name-retransmission-of-messages" class="section-name selfRef">Retransmission of Messages</a>
        </h3>
<p id="section-3.10-1">SCTP provides a reliable and in-sequence transport service for DTLS
   messages that require it.  See <a href="#Stream-Usage" class="auto internal xref">Section 4.4</a>.  Therefore, DTLS
   procedures for retransmissions MUST NOT be used.<a href="#section-3.10-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sctp-considerations">
<section id="section-4">
      <h2 id="name-sctp-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-sctp-considerations" class="section-name selfRef">SCTP Considerations</a>
      </h2>
<div id="Mapping-DTLS">
<section id="section-4.1">
        <h3 id="name-mapping-of-dtls-records">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-mapping-of-dtls-records" class="section-name selfRef">Mapping of DTLS Records</a>
        </h3>
<p id="section-4.1-1">The SCTP implementation MUST support fragmentation of user messages
   using DATA <span>[<a href="#RFC9260" class="cite xref">RFC9260</a>]</span>, and optionally I-DATA <span>[<a href="#RFC8260" class="cite xref">RFC8260</a>]</span> chunks.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">DTLS/SCTP as an SCTP adaptation layer exist between the ULP user
   message API and SCTP. On the sender side a user message is split
   into fragments m0, m1, m2, each no larger than 2<sup>14</sup> =
   16384 bytes or the negotiated maximum DTLS record size
   (<a href="#Msg-size" class="auto internal xref">Section 3.7</a>).<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-3">
<pre>
   m0 | m1 | m2 | ... = user_message
</pre><a href="#section-4.1-3" class="pilcrow">¶</a>
</div>
<p id="section-4.1-4">The resulting fragments are protected with DTLS and the records are
   concatenated<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-5">
<pre>
   user_message' = DTLS( m0 ) | DTLS( m1 ) | DTLS( m2 ) ...
</pre><a href="#section-4.1-5" class="pilcrow">¶</a>
</div>
<p id="section-4.1-6">The new user_message', i.e., the protected user message, is the input
   to SCTP.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7">On the receiving side, the length field in each DTLS record can be
   used to determine the boundaries between DTLS records. DTLS/SCTP
   SHOULD request decryption of each individual records as soon as
   possible.  The last DTLS record can be found by subtracting the
   length of individual records from the length of user_message'.  The
   output from the DTLS decryption(s) is the fragments m0, m1, m2 ...
   The user_message is reassembled from decrypted DTLS records as
   user_message = m0 | m1 | m2 ...<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1-8">There are four failure cases an DTLS/SCTP implementation needs to
   detect and then act on:<a href="#section-4.1-8" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1-9">
<li id="section-4.1-9.1">
            <p id="section-4.1-9.1.1">Failure in decryption and integrity verification process of any
   DTLS record. Due to SCTP-AUTH preventing delivery of injected or
   corrupt fragments of the protected user message this should only
   occur in case of implementation errors or internal hardware
   failures or the necessary security context has been prematurely
   discarded.<a href="#section-4.1-9.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-9.2">
            <p id="section-4.1-9.2.1">In case the SCTP layer indicates an end to a user message,
   e.g., when receiving a MSG_EOR in a recvmsg() call when using the
   API described in <span>[<a href="#RFC6458" class="cite xref">RFC6458</a>]</span>, and the last buffered DTLS record
   length field does not match, i.e., the DTLS record is incomplete.<a href="#section-4.1-9.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-9.3">
            <p id="section-4.1-9.3.1">Unable to perform the decryption processes due to lack of
   resources, such as memory, and have to abandon the user message
   fragment. This specification is defined such that the needed
   resources for the DTLS/SCTP operations are bounded for a given
   number of concurrent transmitted SCTP streams or unordered user
   messages.<a href="#section-4.1-9.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-9.4">
            <p id="section-4.1-9.4.1">DTLS Replay protection. This specification mandates that replay
   protection shall not be used, otherwise the sequence number in a
   delayed DTLS record might be beyond what the replay window accepts
   and thus be dropped. If such a discard would happen the user
   message would be compromised as the data has been lost.<a href="#section-4.1-9.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-4.1-10">The above failure cases all result in the receiver failing to
   recreate the full user message. This is a failure of the transport
   service that is not possible to recover from the DTLS/SCTP layer
   and the sender could believe the complete message have been
   delivered. This error MUST NOT be ignored, as SCTP lacks any
   facility to declare a failure on a specific stream or user message,
   the DTLS connection and the SCTP association SHOULD be
   terminated. A valid exception to the termination of the SCTP
   association is if the receiver is capable of notifying the ULP
   about the failure in delivery and the ULP is capable of recovering
   from this failure.<a href="#section-4.1-10" class="pilcrow">¶</a></p>
<p id="section-4.1-11">Note that if the SCTP extension for Partial Reliability (PR-SCTP)
   <span>[<a href="#RFC3758" class="cite xref">RFC3758</a>]</span> is used for a user message, user message may be
   partially delivered or abandoned. These failures are not a reason
   for terminating the DTLS connection and SCTP association.<a href="#section-4.1-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dtls-connection-handling">
<section id="section-4.2">
        <h3 id="name-dtls-connection-handling">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-dtls-connection-handling" class="section-name selfRef">DTLS Connection Handling</a>
        </h3>
<p id="section-4.2-1">DTLS/SCTP is negotiated on SCTP level as an adaptation layer
   (<a href="#Negotiation" class="auto internal xref">Section 6</a>). After a successful negotiation of the DTLS/SCTP
   adaptation layer during SCTP association establishment, a DTLS
   connection MUST be established prior the transmission of any ULP
   user messages. All DTLS connections are terminated when the SCTP
   association is terminated. A DTLS connection MUST NOT span multiple
   SCTP associations.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">As it is required to establish the DTLS connection at the beginning
   of the SCTP association, either of the peers should never send any
   SCTP user message that is not protected by DTLS. So, the case
   that an endpoint receives data that is neither DTLS messages nor
   protected user messages in the form of a sequence of DTLS Records
   on any stream is a protocol violation. The receiver MAY terminate
   the SCTP association due to this protocol
   violation. Implementations that do not have a DTLS endpoint
   in a state where application_data record can be accepted
   on SCTP handshake completion, will have to ensure
   correct caching of the messages until the DTLS endpoint is ready.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">Whenever a mutual authentication, updated security parameters,
   rerun of Diffie-Hellman Key Exchange, or SCTP-AUTH rekeying is
   needed, a new DTLS connection is instead setup in parallel with the
   old connection (i.e., there may be up to two simultaneous DTLS
   connections within one association).<a href="#section-4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="payload-protocol-identifier-usage">
<section id="section-4.3">
        <h3 id="name-payload-protocol-identifier">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-payload-protocol-identifier" class="section-name selfRef">Payload Protocol Identifier Usage</a>
        </h3>
<p id="section-4.3-1">SCTP Payload Protocol Identifiers are assigned by IANA.
   Application protocols using DTLS over SCTP SHOULD register and use
   a separate Payload Protocol Identifier (PPID) and SHOULD NOT reuse
   the PPID that they registered for running directly over SCTP.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">Using the same PPID does no harm as DTLS/SCTP requires all user
   messages being DTLS protected and knows that DTLS is used.  However,
   for protocol analyzers, for example, it is much easier if a
   separate PPID is used and avoids different behavior from
   <span>[<a href="#RFC6083" class="cite xref">RFC6083</a>]</span>.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">Messages that are exchanged between DTLS/SCTP peers not containing
   ULP user messages shall use PPID = 0 according to section 3.3.1 of
   <span>[<a href="#RFC9260" class="cite xref">RFC9260</a>]</span> as no application identifier can be specified by the
   upper layer for this payload data. With the exception for the
   DTLS/SCTP Control Messages (<a href="#Control-Message" class="auto internal xref">Section 5</a>) that uses its own
   PPID.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Stream-Usage">
<section id="section-4.4">
        <h3 id="name-stream-usage">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-stream-usage" class="section-name selfRef">Stream Usage</a>
        </h3>
<p id="section-4.4-1">DTLS 1.3 protects the actual content type of the DTLS record and
   have therefore omitted the non-protected content type field. Thus,
   it is not possible to determine which content type the DTLS record
   has on SCTP level. For DTLS 1.2 ULP user messages will be carried
   in DTLS records with content type "application_data".<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">DTLS Records carrying protected user message fragments MUST be sent
   in by the ULP indicated SCTP stream and user message and additional
   properties, such as PPID. The ULP has no limitations in using SCTP
   facilities for stream and user messages. DTLS records of other
   types MAY be sent on any SCTP stream. It MAY also be sent in its
   own SCTP user message as well as interleaved with other DTLS
   records carrying protected user message fragments. Thus, it is
   allowed to insert between protected user message fragments DTLS
   records of other types as the DTLS receiver will process these and
   not result in any user message data being inserted into the ULP's
   user message. However, DTLS messages of other types than protected
   user message MUST be sent reliable, so the DTLS record can only be
   interleaved in case the ULP user message is sent as reliable.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3">DTLS is capable of handling reordering of the DTLS
   records. However, depending on stream properties and which user
   message DTLS records of other types are sent in may impact in which
   order and how quickly they are possible to process. Using the same
   stream with in-order delivery for the different messages will
   ensure that the DTLS Records are delivered in the order they are
   sent in user messages. Thus, ensuring that if there are DTLS
   records that need to be delivered in particular order it can be
   ensured. Alternatively, if it is desired that a DTLS record is
   delivered as early as possible, avoiding in-order streams with
   queued messages and considering stream priorities can result in
   faster delivery.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<p id="section-4.4-4">A simple solution avoiding any protocol issue with sending DTLS
   messages, that are not protected user message fragments, is to pick
   a stream not used by the ULP, and send the DTLS messages in their
   own SCTP user messages with in order delivery. That mimics the RFC
   6083 behavior without impacting the ULP. However, it assumes that
   there are available streams to be used based on the SCTP
   association handshake parameter for "maximum inbound streams"
   (Section 5.1.1 of <span>[<a href="#RFC9260" class="cite xref">RFC9260</a>]</span>).<a href="#section-4.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="chunk-handling">
<section id="section-4.5">
        <h3 id="name-chunk-handling">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-chunk-handling" class="section-name selfRef">Chunk Handling</a>
        </h3>
<p id="section-4.5-1">All chunks types that can be listed in the Chunk List Parameter
   <span>[<a href="#RFC4895" class="cite xref">RFC4895</a>]</span>, i.e., all chunks types except INIT, INIT ACK, and
   SHUTDOWN-COMPLETE, MUST be sent in an authenticated way as
   described in <span>[<a href="#RFC4895" class="cite xref">RFC4895</a>]</span>. This makes sure that an attacker cannot
   modify the stream in which a message is sent or affect the
   ordered/unordered delivery of the message. Note that COOKIE ECHO
   and COOKIE ACK are protected with an empty key. This is not a
   problem as everything in these chunks are determined by earlier
   chunks or ignored on receipt.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">If PR-SCTP as defined in <span>[<a href="#RFC3758" class="cite xref">RFC3758</a>]</span> is used, the FORWARD-TSN
   chunks are sent in an authenticated way which makes sure that it is
   not possible for an attacker to drop messages and use forged
   FORWARD-TSN, SACK, and/or SHUTDOWN chunks to hide this dropping.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">I-DATA chunk type as defined in <span>[<a href="#RFC8260" class="cite xref">RFC8260</a>]</span> is RECOMMENDED to be
   supported to avoid some of the down sides that large user messages
   have on blocking transmission of later arriving high priority user
   messages. However, the support is not mandated and negotiated
   independently from DTLS/SCTP.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sctp-auth-hash-function">
<section id="section-4.6">
        <h3 id="name-sctp-auth-hash-function">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-sctp-auth-hash-function" class="section-name selfRef">SCTP-AUTH Hash Function</a>
        </h3>
<p id="section-4.6-1">When using DTLS/SCTP, the SHA-256 Message Digest Algorithm MUST be
   supported in the SCTP-AUTH <span>[<a href="#RFC4895" class="cite xref">RFC4895</a>]</span> implementation. SHA-1 MUST
   NOT be used when using DTLS/SCTP. <span>[<a href="#RFC4895" class="cite xref">RFC4895</a>]</span> requires support and
   inclusion of SHA-1 in the HMAC-ALGO parameter, thus, to meet
   both requirements the HMAC-ALGO parameter will include both SHA-256
   and SHA-1 with SHA-256 listed prior to SHA-1 to indicate the
   preference.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<p id="section-4.6-2">When using DTLS/SCTP, each endpoint MUST use a single SCTP-AUTH
   Message Digest Algorithm during the whole SCTP association. This
   guarantees that an association shared key is only used with a single
   algorithm.<a href="#section-4.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Parallel-Dtls">
<section id="section-4.7">
        <h3 id="name-parallel-dtls-connections">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-parallel-dtls-connections" class="section-name selfRef">Parallel DTLS connections</a>
        </h3>
<p id="section-4.7-1">To enable SCTP-AUTH rekeying, periodic authentication of both
   endpoints, and force attackers to dynamic key extraction
   <span>[<a href="#RFC7624" class="cite xref">RFC7624</a>]</span>, DTLS/SCTP per this specification defines the usage of
   parallel DTLS connections over the same SCTP association. This
   solution ensures that there are no limitations to the lifetime of
   the SCTP association due to DTLS, it also avoids dependency on
   version specific DTLS mechanisms such as renegotiation in DTLS 1.2,
   which is disabled by default in many DTLS implementations, or
   post-handshake messages in DTLS 1.3, which does not allow periodic
   mutual endpoint re-authentication or re-keying of
   SCTP-AUTH.<a href="#section-4.7-1" class="pilcrow">¶</a></p>
<p id="section-4.7-2">Parallel DTLS connections enable opening a new DTLS
   connection performing an handshake, while the existing DTLS
   connection is kept in place.  In DTLS 1.3 the handshake MAY be a
   full handshake or a resumption handshake, and resumption can be done
   while the original connection is still open. In DTLS 1.2 the
   handshake MUST be a full handshake. The new parallel connection MUST
   use the same DTLS version as the existing connection.<a href="#section-4.7-2" class="pilcrow">¶</a></p>
<p id="section-4.7-3">On DTLS handshake completion, DTLS/SCTP starts using
   the security context of the new DTLS connection for protection
   of ULP user messages and then ensure delivery of all the SCTP chunks
   using the old DTLS connections security context. When that has been
   achieved DTLS/SCTP shall close the old DTLS connection and discard
   the related security context.<a href="#section-4.7-3" class="pilcrow">¶</a></p>
<p id="section-4.7-4">As specified in <a href="#Mapping-DTLS" class="auto internal xref">Section 4.1</a> the usage of DTLS connection ID is
   required to ensure that the receiver can correctly identify the
   DTLS connection and its security context when performing its
   de-protection operations. There is also only a single SCTP-AUTH key
   exported per DTLS connection and transmission direction ensuring
   that there is clear mapping between the DTLS connection ID and the
   SCTP-AUTH security context for each Key Identifier.<a href="#section-4.7-4" class="pilcrow">¶</a></p>
<p id="section-4.7-5">Application writers should be aware that establishing a new DTLS
   connection may result in changes of security parameters.  See
   <a href="#sec-Consideration" class="auto internal xref">Section 9</a> for security considerations regarding rekeying.<a href="#section-4.7-5" class="pilcrow">¶</a></p>
<p id="section-4.7-6">A DTLS/SCTP Endpoint MUST NOT have more than two DTLS connections
   open at the same time. Either of the endpoints MAY initiate a new
   DTLS connection by performing a DTLS handshake. To support this
   implementations and certificates need to support both DTLS client
   and server roles. Note that resumption is not possible between DTLS
   connections unless the endpoints have the same roles. As either
   endpoint can initiate a DTLS handshake on either side at the same
   time, either endpoint may receive a DTLS ClientHello message when
   it has sent its own ClientHello. In this case the ClientHello from
   the endpoint that had the DTLS Client role in the establishment of
   the existing DTLS connection shall be continued to be processed and
   the other dropped.<a href="#section-4.7-6" class="pilcrow">¶</a></p>
<p id="section-4.7-7">When performing the DTLS handshake the endpoint MUST verify that
   the peer identifies using the same identity as in the previous DTLS
   connection.<a href="#section-4.7-7" class="pilcrow">¶</a></p>
<p id="section-4.7-8">When the DTLS handshake has been completed, the new DTLS connection
   MUST be used for the DTLS protection of any new ULP user message,
   and SHOULD be switched to for protection of not yet protected user
   message fragments of partially transmitted user messages.  Also,
   after the completion of the DTLS handshake, a new SCTP-AUTH key will
   be exported per <a href="#handling-endpoint-secret" class="auto internal xref">Section 4.8</a>. To enable the sender
   and receiver to correctly identify when the old DTLS connection is
   no longer in use, the SCTP-AUTH key used to protect a SCTP packet
   MUST NOT be from a newer DTLS connection than produced any included
   DTLS record fragment.<a href="#section-4.7-8" class="pilcrow">¶</a></p>
<p id="section-4.7-9">The SCTP API defined in <span>[<a href="#RFC6458" class="cite xref">RFC6458</a>]</span> has limitation in changing the
   SCTP-AUTH key until the whole SCTP user message has been
   delivered. However, the DTLS/SCTP implementation can switch the
   DTLS connection used to protect the user message fragments to a
   newer, even if the older DTLS connections exported key is used
   for the SCTP-AUTH. And for SCTP implementations where the SCTP-AUTH
   key can be switched in the middle of a user message the SCTP-AUTH
   key should be changed as soon as all DTLS record fragments included
   in an SCTP packet have been protected by the newer DTLS connection.
   Any SCTP-AUTH receiver implementation is expected to be able to
   select key on per SCTP packet basis.<a href="#section-4.7-9" class="pilcrow">¶</a></p>
<p id="section-4.7-10">The DTLS/SCTP endpoint timely indicates to its peer when the
   previous DTLS connection and its context are no longer needed for
   receiving any more data from this endpoint. This is done by sending
   a DTLS/SCTP Control Message (<a href="#Control-Message" class="auto internal xref">Section 5</a>) of type
   "Ready_To_Close" (<a href="#Ready_To_Close" class="auto internal xref">Section 5.2</a>) to its peer. The endpoint MUST
   NOT send the Ready_To_Close until the following two conditions are
   fulfilled:<a href="#section-4.7-10" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.7-11">
<li id="section-4.7-11.1">
            <p id="section-4.7-11.1.1">All SCTP packets containing part of any DTLS record or message
protected using the security context of this DTLS connection
have been acknowledged in a non-renegable way.<a href="#section-4.7-11.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.7-11.2">
            <p id="section-4.7-11.2.1">All SCTP packets using the SCTP-AUTH key associated with the
security context of this DTLS connection have been acknowledged
in a non-renegable way.<a href="#section-4.7-11.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-4.7-12">A DTLS/SCTP endpoint that fulfills the above conditions for the
   SCTP packets it sends, and have received a Ready_To_Close message,
   SHALL immediately initiate closing of this DTLS connection by
   sending a DTLS close_notify. Then when it has received the peer's
   close_notify terminate the DTLS connection and expunges the
   associated security context and SCTP-AUTH key. Note that it is not
   required for a DTLS/SCTP implementation that has received a
   Ready_To_Close message to send that message itself when it
   fulfills the conditions. However, in some situations both endpoints
   will fulfill the conditions close enough in time that both
   endpoints will send their Ready_To_Close prior to receiving the
   indication from the peer, that works as both endpoints will then
   initiate DTLS close_notify and terminate the DTLS connections upon
   the reception of the peers close_notify.<a href="#section-4.7-12" class="pilcrow">¶</a></p>
<p id="section-4.7-13">SCTP implementations exposing APIs like <span>[<a href="#RFC6458" class="cite xref">RFC6458</a>]</span> fulfilling
   these conditions require draining the SCTP association of all
   outstanding data after having completed all the user messages using
   the previous SCTP-AUTH key identifier, relying on the
   SCTP_SENDER_DRY_EVENT to know when delivery has been accomplished.
   A richer API could also be used that allows user message level
   tracking of delivery, see <a href="#api-considerations" class="auto internal xref">Section 7</a> for API
   considerations.<a href="#section-4.7-13" class="pilcrow">¶</a></p>
<p id="section-4.7-14">For SCTP implementations exposing APIs like <span>[<a href="#RFC6458" class="cite xref">RFC6458</a>]</span> where it is
   not possible to change the SCTP-AUTH key for a partial SCTP message
   initiated before the change of security context, it will be forced to
   track the SCTP messages and determine when all using the old
   security context has been transmitted. This maybe be impossible to
   do completely reliable without tighter integration between the
   DTLS/SCTP layer and the SCTP implementation. This type of
   implementations also has an implicit limitation in how large SCTP
   messages it can support. Each SCTP message needs to have completed
   delivery and enabling closing of the previous DTLS connection prior
   to the need to create yet another DTLS connection. Thus, SCTP
   messages can't be larger than that the transmission completes in
   less than the duration between the rekeying or re-authentications
   needed for this SCTP association.<a href="#section-4.7-14" class="pilcrow">¶</a></p>
<p id="section-4.7-15">The consequences of sending a DTLS close_notify alert in the old
   DTLS connection prior to the receiver having received the data can
   result in failure case 1 described in <a href="#Mapping-DTLS" class="auto internal xref">Section 4.1</a>, which likely
   result in SCTP association termination.<a href="#section-4.7-15" class="pilcrow">¶</a></p>
</section>
</div>
<div id="handling-endpoint-secret">
<section id="section-4.8">
        <h3 id="name-handling-of-endpoint-pair-s">
<a href="#section-4.8" class="section-number selfRef">4.8. </a><a href="#name-handling-of-endpoint-pair-s" class="section-name selfRef">Handling of Endpoint Pair Shared Secrets</a>
        </h3>
<p id="section-4.8-1">Editor's Note: Assuming that RFC 4895 is updates to address the
   security issues this section is expected to be able to be updated
   to not require generating two different keys.<a href="#section-4.8-1" class="pilcrow">¶</a></p>
<p id="section-4.8-2">SCTP-AUTH <span>[<a href="#RFC4895" class="cite xref">RFC4895</a>]</span> is keyed using endpoint pair shared
   secrets. In DTLS/SCTP, DTLS is used to establish these secrets.
   The endpoint pair shared secrets MUST be provided to the SCTP stack
   as soon as the computation is possible. The endpoints MUST NOT use
   another mechanism for establishing endpoint pair shared secrets for
   SCTP-AUTH.  The endpoint pair shared secret for Shared Key
   Identifier zero (0) is empty, it is used by both endpoints
   when establishing the first DTLS connection and MUST NOT be
   used to protect ULP data.<a href="#section-4.8-2" class="pilcrow">¶</a></p>
<p id="section-4.8-3">The initial DTLS connection will be used to establish two new
   endpoint pair shared secrets which MUST use shared key identifier 2
   and 3. The endpoint pair shared secrets are derived using the TLS
   exporter interface using the ASCII strings
   "EXPORTER-DTLS-OVER-SCTP-CLIENT-WRITE" and
   "EXPORTER-DTLS-OVER-SCTP-SERVER-WRITE" with no terminating NUL, no
   context, and length 64.<a href="#section-4.8-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.8-4">
<pre>
TLS-Exporter("EXPORTER-DTLS-OVER-SCTP-CLIENT-WRITE", , 64)
TLS-Exporter("EXPORTER-DTLS-OVER-SCTP-SERVER-WRITE", , 64)
</pre><a href="#section-4.8-4" class="pilcrow">¶</a>
</div>
<p id="section-4.8-5">Keys derived with the label "EXPORTER-DTLS-OVER-SCTP-CLIENT-WRITE"
   always have an even Shared Key Identifier.  They are used by the
   TLS client for sending AUTH chunks and MUST NOT be used by the TLS
   client for receiving AUTH chunks.  Keys derived with the label
   "EXPORTER-DTLS-OVER-SCTP-SERVER-WRITE" always have an odd Shared
   Key Identifier.  They are used by the TLS server for sending AUTH
   chunks and MUST NOT be used by the TLS server for receiving AUTH
   chunks.  These directional keys change the behavior of SCTP-AUTH
   <span>[<a href="#RFC4895" class="cite xref">RFC4895</a>]</span> and requires extensions to the SCTP API defined in
   <span>[<a href="#RFC6458" class="cite xref">RFC6458</a>]</span>.<a href="#section-4.8-5" class="pilcrow">¶</a></p>
<p id="section-4.8-6">When a subsequent DTLS connection is setup, two new 64-byte
   endpoint pair shared secrets are derived using the TLS-Exporter as
   defined above. The Shared Key Identifiers form a sequence. If the
   previous endpoint pair shared secrets used Shared Key Identifiers
   2n and 2n+1, the new ones MUST use Shared Key Identifier 2n+2 and
   2n+3, unless 2n = 65534, in which case the new Shared Key
   Identifiers are 2 and 3.<a href="#section-4.8-6" class="pilcrow">¶</a></p>
<p id="section-4.8-7">A DTLS connection MUST NOT be used be used for protection of ULP
   data before the two SCTP-AUTH endpoint pair shared secrets has been
   exported and the other endpoint has been authenticated.<a href="#section-4.8-7" class="pilcrow">¶</a></p>
<div id="dtls-12-considerations">
<section id="section-4.8.1">
          <h4 id="name-dtls-12-considerations">
<a href="#section-4.8.1" class="section-number selfRef">4.8.1. </a><a href="#name-dtls-12-considerations" class="section-name selfRef">DTLS 1.2 Considerations</a>
          </h4>
<p id="section-4.8.1-1">Whenever a new DTLS connection is established, two 64-byte endpoint
   pair shared secrets are derived using the TLS-Exporter described in
   <span>[<a href="#RFC5705" class="cite xref">RFC5705</a>]</span>.<a href="#section-4.8.1-1" class="pilcrow">¶</a></p>
<p id="section-4.8.1-2">After sending or receiving the DTLS client Finished message for the
   initial DTLS connection, the active SCTP-AUTH key MUST be switched
   from key identifier zero (0) to key identifiers 2 and 3 and the
   SCTP-AUTH Shared Key Identifier zero MUST NOT be used.<a href="#section-4.8.1-2" class="pilcrow">¶</a></p>
<p id="section-4.8.1-3">When the endpoint has sent or received a close_notify on the old DTLS
   connection then the endpoint SHALL remove the two SCTP-AUTH endpoint
   pair shared secrets derived from the old DTLS connection.<a href="#section-4.8.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dtls-13-considerations">
<section id="section-4.8.2">
          <h4 id="name-dtls-13-considerations">
<a href="#section-4.8.2" class="section-number selfRef">4.8.2. </a><a href="#name-dtls-13-considerations" class="section-name selfRef">DTLS 1.3 Considerations</a>
          </h4>
<p id="section-4.8.2-1">Whenever a new exporter_secret can be computed, two 64-byte
   endpoint pair shared secrets are derived using the TLS-Exporter
   described in Section 7.5 of <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>.<a href="#section-4.8.2-1" class="pilcrow">¶</a></p>
<p id="section-4.8.2-2">After sending or receiving the DTLS server Finished message for the
   initial DTLS connection, the active SCTP-AUTH key MUST be switched
   from key identifier zero (0) to key identifiers 2 and 3 and the
   SCTP-AUTH Shared Key Identifier zero MUST NOT be used.<a href="#section-4.8.2-2" class="pilcrow">¶</a></p>
<p id="section-4.8.2-3">When the endpoint has sent or received a close_notify in one
   direction on the old DTLS connection then the endpoint SHALL remove
   the SCTP-AUTH endpoint pair shared secret associated with that
   direction in the old DTLS connection.<a href="#section-4.8.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-shutdown">
<section id="section-4.9">
        <h3 id="name-shutdown">
<a href="#section-4.9" class="section-number selfRef">4.9. </a><a href="#name-shutdown" class="section-name selfRef">Shutdown</a>
        </h3>
<p id="section-4.9-1">To prevent DTLS from discarding DTLS user messages while it is
   shutting down, the below procedure has been defined. Its goal is to
   avoid the need for APIs requiring per user message data level
   acknowledgments and utilizes existing SCTP protocol behavior to
   ensure delivery of the protected user messages data.<a href="#section-4.9-1" class="pilcrow">¶</a></p>
<p id="section-4.9-2">To support DTLS 1.2 close_notify behavior and avoid any uncertainty
   related to rekeying, a DTLS/SCTP protocol message
   (<a href="#Control-Message" class="auto internal xref">Section 5</a>) sent as protected SCTP user message is
   defined, with its own PPID, to inform the DTLS/SCTP layer that
   it is targeting the remote DTLS/SCTP function and act on the
   request to close in a controlled fashion.<a href="#section-4.9-2" class="pilcrow">¶</a></p>
<p id="section-4.9-3">The shutdown procedure is initiated by any of the two peers,
   targeting the closure of the SCTP Association and the DTLS
   connections.  In order to ensure that shutdown is completed without
   data lost, DTLS/SCTP must control that both SCTP Tx buffers are
   empty first, then it must ensure that all data in SCTP Rx buffer
   has been fetched and delivered to ULP and finally it shall shutdown
   the DTLS connections and the SCTP Association.<a href="#section-4.9-3" class="pilcrow">¶</a></p>
<p id="section-4.9-4">The interaction between peers (local and remote) and protocol
   stacks is as follows:<a href="#section-4.9-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.9-5">
<li id="section-4.9-5.1">
            <p id="section-4.9-5.1.1">Local instance of ULP asks for terminating the DTLS/SCTP
   Association.<a href="#section-4.9-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.9-5.2">
            <p id="section-4.9-5.2.1">Local DTLS/SCTP acknowledges the request, from this time on no
   new data from local instance of ULP will be accepted.<a href="#section-4.9-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.9-5.3">
            <p id="section-4.9-5.3.1">Local DTLS/SCTP finishes any protection operation on buffered
   user messages and ensures that all protected user message data has
   been successfully transferred to the remote peer.<a href="#section-4.9-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.9-5.4">
            <p id="section-4.9-5.4.1">Local DTLS/SCTP sends a DTLS/SCTP Control Message
   (<a href="#Control-Message" class="auto internal xref">Section 5</a>) of type "SHUTDOWN_Request"
   (<a href="#SHUTDOWN-Request" class="auto internal xref">Section 5.1</a>) to its peer.<a href="#section-4.9-5.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.9-5.5">
            <p id="section-4.9-5.5.1">The remote DTLS/SCTP, when receiving the SHUTDOWN-Request,
   informs its ULP that shutdown has been initiated. No more ULP user
   message data to be sent to the peer can be accepted by DTLS/SCTP.<a href="#section-4.9-5.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.9-5.6">
            <p id="section-4.9-5.6.1">Remote DTLS/SCTP finishes any protection operation on buffered
   user messages and ensures that all protected user message data has
   been successfully transferred to the remote ULP.<a href="#section-4.9-5.6.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.9-5.7">
            <p id="section-4.9-5.7.1">Remote DTLS/SCTP sends DTLS close_notify to Local DTLS/SCTP
   for each and all DTLS connections. Then it initiates the
   SCTP shutdown procedure (section 9.2 of <span>[<a href="#RFC9260" class="cite xref">RFC9260</a>]</span>).<a href="#section-4.9-5.7.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.9-5.8">
            <p id="section-4.9-5.8.1">When the local DTLS/SCTP receives a close_notify on a DTLS
   connection, in case it is DTLS 1.3 it SHALL send its corresponding
   DTLS close_notify on each open DTLS connection. When the last open
   DTLS connection has received close_notify and any if needed
   corresponding close_notify have been sent, the local DTLS/SCTP
   initiates the SCTP shutdown procedure (section 9.2 of <span>[<a href="#RFC9260" class="cite xref">RFC9260</a>]</span>).<a href="#section-4.9-5.8.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.9-5.9">
            <p id="section-4.9-5.9.1">Upon receiving the information that SCTP has closed the
   Association, independently the local and remote DTLS/SCTP entities
   destroy the DTLS connection completing the shutdown.<a href="#section-4.9-5.9.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-4.9-6">The verification in step 3 and 6 that all user data message has been
   successfully delivered to the remote ULP can be provided by the
   SCTP stack that implements <span>[<a href="#RFC6458" class="cite xref">RFC6458</a>]</span> by means of SCTP_SENDER_DRY
   event (section 6.1.9 of <span>[<a href="#RFC6458" class="cite xref">RFC6458</a>]</span>).<a href="#section-4.9-6" class="pilcrow">¶</a></p>
<p id="section-4.9-7">A successful SCTP shutdown will indicate successful delivery of all
   data. However, in cases of communication failures and extensive
   packet loss the SCTP shutdown procedure can time out and result in
   SCTP association termination where its unknown if all data has been
   delivered. The DTLS/SCTP should indicate to ULP successful
   completion or failure to shutdown gracefully.<a href="#section-4.9-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="transmission-limitations">
<section id="section-4.10">
        <h3 id="name-transmission-limitations">
<a href="#section-4.10" class="section-number selfRef">4.10. </a><a href="#name-transmission-limitations" class="section-name selfRef">Transmission Limitations</a>
        </h3>
<div id="Prevent-DTLS-Seq-wraps">
<section id="section-4.10.1">
          <h4 id="name-preventing-dtls-sequence-nu">
<a href="#section-4.10.1" class="section-number selfRef">4.10.1. </a><a href="#name-preventing-dtls-sequence-nu" class="section-name selfRef">Preventing DTLS sequence number wraps</a>
          </h4>
<p id="section-4.10.1-1">To avoid failures in DTLS record decryption it is necessary to
   ensure that the sequence number space never wraps for the DTLS
   records that are outstanding between the DTLS encryption and
   decryption. As discussed in <a href="#buffering" class="auto internal xref">Section 1.4</a> the amount of packets
   this include is a combination of any buffering in the endpoint and
   the amount of data in the SCTP sender/receiver buffer for the
   transmission.<a href="#section-4.10.1-1" class="pilcrow">¶</a></p>
<p id="section-4.10.1-2">To avoid overlapping sequence number the DTLS sender should first
   of all use 16-bit sequence number to enable a larger
   space. Secondly, it should track which DTLS records has been
   non-renegable ACKed by the receiver and always maintain a certain
   safety buffer in number of DTLS records. Thirdly, the
   implementation needs to attempt to minimize usage of buffers that
   exist after the DTLS encryption until the DTLS Decryption in its
   sender and receiver implementation.<a href="#section-4.10.1-2" class="pilcrow">¶</a></p>
<p id="section-4.10.1-3">If the receiver implementation keeps with the assumption to timely
   decrypt DTLS records after it has been completely received, the
   tracking of when a records has been fully received can maintain a
   good view of the total number of outstanding records in regard to
   the DTLS sequence number space and prevent wrapping of the sequence
   number space by not protecting additional user message fragments
   until further DTLS records has been acknowledged.<a href="#section-4.10.1-3" class="pilcrow">¶</a></p>
<p id="section-4.10.1-4">Assuming a that a quarter of the sequence number space is used as
   safety margin it will limit the number of simultaneous in-flight
   DTLS records to 49152, and thus also the number of simultaneous user
   messages. Technically, if the DTLS implementation supports trial
   decoding, overlap of the sequence number but that results in both
   implementation requirements, need to signal the window it supports,
   and additional decryption overhead due to trial decoding and will
   be left for future extension.<a href="#section-4.10.1-4" class="pilcrow">¶</a></p>
<p id="section-4.10.1-5">So, what size of SCTP receiver window this limitation corresponds
   to is highly dependent on the SCTP user message size. If all SCTP
   user messages are large, e.g., 1 MB, then most DTLS Records will be
   close to maximum DTLS record size. Thus, the SCTP receiver window
   size required before this becomes an issue becomes fairly close to
   49152 times 16384, i.e., approximately 800 MB. While SCTP user
   messages of almost exclusively 100 bytes would only need a receiver
   window of approximately 5 MB.<a href="#section-4.10.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sctp-api-limitations">
<section id="section-4.10.2">
          <h4 id="name-sctp-api-limitations">
<a href="#section-4.10.2" class="section-number selfRef">4.10.2. </a><a href="#name-sctp-api-limitations" class="section-name selfRef">SCTP API Limitations</a>
          </h4>
<p id="section-4.10.2-1">The SCTP-API defined in <span>[<a href="#RFC6458" class="cite xref">RFC6458</a>]</span> results in an implementation
   limitation when it comes to support transmission of user messages
   of arbitrary sizes. That API does not allow changing the SCTP-AUTH
   key used for protecting the sending of a particular user
   message. Thus, user messages that will be transmitted over periods
   of time on the order or longer than the interval between rekeying
   can't be supported. Beyond delaying the completion of a rekeying
   until the message has been transmitted, the session can deadlock if
   the DTLS connection used to protect this long user message reaches
   the limit of number of bytes transmitted with a particular
   key. However, this is not an interoperability issue as it is the
   sender side's API that limits what can be sent and thus the sender
   implementation will have to address this issue.<a href="#section-4.10.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="Control-Message">
<section id="section-5">
      <h2 id="name-dtls-sctp-control-message">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-dtls-sctp-control-message" class="section-name selfRef">DTLS/SCTP Control Message</a>
      </h2>
<p id="section-5-1">The DTLS/SCTP Control Message is defined as its own upper layer
   protocol for DTLS/SCTP identified by its own PPID. The control
   message is sent in network byte order.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">The first 32 bits are split in two 16-bit integers where the first
   contains the Control Message Number and the next 16-bit integer
   contains the length of the optional Variable Parameter.
   Granularity of Variable Parameter is 32-bit with trailing zeroes.<a href="#section-5-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-3">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       Control Message No      |      Parameter Length         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\                                                               \
/                      Variable Parameter                       /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-5-3" class="pilcrow">¶</a>
</div>
<p id="section-5-4">Each message is sent as its own SCTP user message after
   having been protected by an open DTLS connection on any SCTP stream
   and MUST be marked with SCTP Payload Protocol Identifier (PPID)
   value TBD1 (<a href="#sec-IANA-PPID" class="auto internal xref">Section 8.4</a>).<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">The DTLS/SCTP implementation MUST consume all SCTP messages
   received with the PPID value of TBD1. If the message is not 32-bit
   long the message MUST be discarded and the error SHOULD be logged.
   In case the message has an unknown value the message is
   discarded and the event SHOULD be logged.<a href="#section-5-5" class="pilcrow">¶</a></p>
<p id="section-5-6">Two control messages are defined in this specification.<a href="#section-5-6" class="pilcrow">¶</a></p>
<div id="SHUTDOWN-Request">
<section id="section-5.1">
        <h3 id="name-shutdown-request">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-shutdown-request" class="section-name selfRef">SHUTDOWN-Request</a>
        </h3>
<p id="section-5.1-1">The value "1" is defined as a request to the peer to initiate
   controlled shutdown. This is used per step 4 and 5 in
   <a href="#sec-shutdown" class="auto internal xref">Section 4.9</a>.  Control Message 1 "Shutdown request" has
   Parameter Length = 0.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Ready_To_Close">
<section id="section-5.2">
        <h3 id="name-ready-to-close-indication">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-ready-to-close-indication" class="section-name selfRef">Ready To Close Indication</a>
        </h3>
<p id="section-5.2-1">The value "2" is defined as an indication to the peer that from its
   perspective all SCTP packets with user message or using the
   SCTP-AUTH key associated with the indicated DTLS connection have been
   sent and acknowledged as received in a non-renegable way. This is
   used per <a href="#Parallel-Dtls" class="auto internal xref">Section 4.7</a> to initiate the closing of the DTLS
   connections during rekeying.  Control Message 2 "Ready To Close"
   has Parameter Length equal to the size of the DTLS Connection ID
   parameter in bytes.  The Variable Parameter contains the DTLS
   Connection ID that is to be closed.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="Negotiation">
<section id="section-6">
      <h2 id="name-dtls-over-sctp-service">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-dtls-over-sctp-service" class="section-name selfRef">DTLS over SCTP Service</a>
      </h2>
<p id="section-6-1">The adoption of DTLS over SCTP according to the current
   specification is meant to add to SCTP the option for transferring
   encrypted data.  When DTLS over SCTP is used, all data being
   transferred MUST be protected by chunk authentication and DTLS
   encrypted.  Chunks that need to be received in an authenticated way
   will be specified in the CHUNK list parameter according to
   <span>[<a href="#RFC4895" class="cite xref">RFC4895</a>]</span>.  Error handling for authenticated chunks is according
   to <span>[<a href="#RFC4895" class="cite xref">RFC4895</a>]</span>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="adaptation-layer-indication-in-initinit-ack">
<section id="section-6.1">
        <h3 id="name-adaptation-layer-indication">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-adaptation-layer-indication" class="section-name selfRef">Adaptation Layer Indication in INIT/INIT ACK</a>
        </h3>
<p id="section-6.1-1">At the initialization of the association, a sender of the INIT or
   INIT ACK chunk that intends to use DTLS/SCTP as specified in this
   specification MUST include an Adaptation Layer Indication Parameter
   <span>[<a href="#RFC5061" class="cite xref">RFC5061</a>]</span> with the IANA assigned value TBD
   (<a href="#sec-IANA-ACP" class="auto internal xref">Section 8.3</a>) to inform its peer that it is able to support
   DTLS over SCTP per this specification.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="DTLS-init">
<section id="section-6.2">
        <h3 id="name-dtls-over-sctp-initializati">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-dtls-over-sctp-initializati" class="section-name selfRef">DTLS over SCTP Initialization</a>
        </h3>
<p id="section-6.2-1">Initialization of DTLS/SCTP requires all the following options to
   be part of the INIT/INIT ACK handshake:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">RANDOM: defined in <span>[<a href="#RFC4895" class="cite xref">RFC4895</a>]</span><a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">CHUNKS: defined in <span>[<a href="#RFC4895" class="cite xref">RFC4895</a>]</span><a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">HMAC-ALGO: defined in <span>[<a href="#RFC4895" class="cite xref">RFC4895</a>]</span><a href="#section-6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.2-5">ADAPTATION-LAYER-INDICATION: defined in <span>[<a href="#RFC5061" class="cite xref">RFC5061</a>]</span><a href="#section-6.2-5" class="pilcrow">¶</a></p>
<p id="section-6.2-6">When all the above options are present and having acceptable
   parameters, the Association will start with support of DTLS/SCTP.
   The set of options indicated are the DTLS/SCTP Mandatory Options.
   No data transfer is permitted before DTLS handshake is
   completed. Chunk bundling is permitted according to
   <span>[<a href="#RFC9260" class="cite xref">RFC9260</a>]</span>. The DTLS handshake will enable authentication of both
   the peers.<a href="#section-6.2-6" class="pilcrow">¶</a></p>
<p id="section-6.2-7">The extension described in this document is given by the following
   message exchange.<a href="#section-6.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-8">
<pre>
   --- INIT[RANDOM; CHUNKS; HMAC-ALGO; ADAPTATION-LAYER-IND] ---&gt;
   &lt;- INIT ACK[RANDOM; CHUNKS; HMAC-ALGO; ADAPTATION-LAYER-IND] -
   --------------------- AUTH; COOKIE ECHO ---------------------&gt;
   &lt;-------------------- AUTH; COOKIE ACK -----------------------
   ---------------- AUTH; DATA[DTLS Handshake] -----------------&gt;
                               ...
                               ...
   &lt;--------------- AUTH; DATA[DTLS Handshake] ------------------
</pre><a href="#section-6.2-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="client-use-case">
<section id="section-6.3">
        <h3 id="name-client-use-case">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-client-use-case" class="section-name selfRef">Client Use Case</a>
        </h3>
<p id="section-6.3-1">When a client initiates an SCTP Association with DTLS protection,
   i.e., the SCTP INIT containing DTLS/SCTP Mandatory Options, it can
   receive an INIT ACK also containing DTLS/SCTP Mandatory Options, in
   that case the Association will proceed as specified in the previous
   <a href="#DTLS-init" class="auto internal xref">Section 6.2</a> section.  If the peer replies with an INIT ACK not
   containing all DTLS/SCTP Mandatory Options, the client SHOULD reply
   with an SCTP ABORT.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-use-case">
<section id="section-6.4">
        <h3 id="name-server-use-case">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-server-use-case" class="section-name selfRef">Server Use Case</a>
        </h3>
<p id="section-6.4-1">If a SCTP Server supports DTLS/SCTP, i.e., per this specification,
   when receiving an INIT chunk with all DTLS/SCTP Mandatory Options
   it will reply with an INIT ACK also containing all the DTLS/SCTP
   Mandatory Options, following the sequence for DTLS initialization
   <a href="#DTLS-init" class="auto internal xref">Section 6.2</a> and the related traffic case.  If a SCTP Server that
   supports DTLS and configured to use it, receives an INIT chunk
   without all DTLS/SCTP Mandatory Options, it SHOULD reply with an
   SCTP ABORT.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Fallback">
<section id="section-6.5">
        <h3 id="name-rfc-6083-fallback">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-rfc-6083-fallback" class="section-name selfRef">RFC 6083 Fallback</a>
        </h3>
<p id="section-6.5-1">This section discusses how an endpoint supporting this
   specification can fallback to follow the DTLS/SCTP behavior in
   RFC6083.  It is recommended to define a setting that represents the
   policy to allow fallback or not. However, the possibility to use
   fallback is based on the ULP can operate using user messages that
   are no longer than 16384 bytes and where the security issues can be
   mitigated or considered acceptable. If fallback is enabled,
   implementations MUST use the dtls_sctp_ext extension
   (<a href="#auth_fallback" class="auto internal xref">Section 6.5.3</a>) to authenticate the fallback. This mitigates
   on-path attacker to trigger fallback to RFC 6083. Fallback is NOT
   RECOMMENDED to be enabled as it permits weaker algorithms and
   versions of DTLS.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">An SCTP endpoint that receives an INIT chunk or an INIT ACK chunk
   that does not contain the SCTP-Adaptation-Indication parameter with
   the DTLS/SCTP adaptation layer codepoint, see <a href="#sec-IANA-ACP" class="auto internal xref">Section 8.3</a>, may
   in certain cases potentially perform a fallback to RFC 6083
   behavior.  However, the fallback attempt should only be performed
   if policy says that is acceptable.<a href="#section-6.5-2" class="pilcrow">¶</a></p>
<p id="section-6.5-3">If fallback is allowed, it is possible that the client will send
   plain text user messages prior to DTLS handshake as it is allowed
   per RFC 6083.  So that needs to be part of the consideration for a
   policy allowing fallback.<a href="#section-6.5-3" class="pilcrow">¶</a></p>
<div id="client-fallback">
<section id="section-6.5.1">
          <h4 id="name-client-fallback">
<a href="#section-6.5.1" class="section-number selfRef">6.5.1. </a><a href="#name-client-fallback" class="section-name selfRef">Client Fallback</a>
          </h4>
<p id="section-6.5.1-1">A DTLS/SCTP client supporting this specification encountering a
   server not compatible with this specification MAY attempt RFC 6083
   fallback per this procedure.<a href="#section-6.5.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.5.1-2">
<li id="section-6.5.1-2.1">
              <p id="section-6.5.1-2.1.1">Fallback procedure, if enabled, is initiated when receiving an
SCTP INIT ACK that does not contain the DTLS/SCTP Adaptation
Layer indication. If fallback is not enabled the SCTP handshake
is aborted.<a href="#section-6.5.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.5.1-2.2">
              <p id="section-6.5.1-2.2.1">The client checks that the SCTP INIT ACK contained the necessary
chunks and parameters to establish SCTP-AUTH per RFC 6083 with
this endpoint. If not all necessary parameters or support
algorithms don't match the client MUST abort the
handshake. Otherwise it completes the SCTP handshake.<a href="#section-6.5.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.5.1-2.3">
              <p id="section-6.5.1-2.3.1">Client performs DTLS connection handshake per RFC 6083 over
established SCTP association. If successful authenticating the
targeted server the client has successful fallen back to use
RFC 6083. If not terminate the SCTP association.<a href="#section-6.5.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="server-fallback">
<section id="section-6.5.2">
          <h4 id="name-server-fallback">
<a href="#section-6.5.2" class="section-number selfRef">6.5.2. </a><a href="#name-server-fallback" class="section-name selfRef">Server Fallback</a>
          </h4>
<p id="section-6.5.2-1">A DTLS/SCTP Server that supports both this specification and RFC
   6083 and where fallback has been enabled for the ULP can follow
   this procedure.<a href="#section-6.5.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.5.2-2">
<li id="section-6.5.2-2.1">
              <p id="section-6.5.2-2.1.1">When receiving an SCTP INIT message without the DTLS/SCTP
adaptation layer indication fallback procedure is initiated.<a href="#section-6.5.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.5.2-2.2">
              <p id="section-6.5.2-2.2.1">Verify that the SCTP INIT contains SCTP-AUTH parameters required
by RFC 6083 and compatible with this server. If that is not the
case abort the SCTP handshake.<a href="#section-6.5.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.5.2-2.3">
              <p id="section-6.5.2-2.3.1">Send an SCTP INIT ACK with the required SCTP-AUTH chunks and
parameters to the client.<a href="#section-6.5.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.5.2-2.4">
              <p id="section-6.5.2-2.4.1">Complete the SCTP Handshake. Await DTLS handshake per RFC 6083.
Plain text SCTP messages MAY be received.<a href="#section-6.5.2-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.5.2-2.5">
              <p id="section-6.5.2-2.5.1">Upon successful completion of DTLS handshake successful fallback
to RFC 6083 have been accomplished.<a href="#section-6.5.2-2.5.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="auth_fallback">
<section id="section-6.5.3">
          <h4 id="name-authenticated-fallback">
<a href="#section-6.5.3" class="section-number selfRef">6.5.3. </a><a href="#name-authenticated-fallback" class="section-name selfRef">Authenticated Fallback</a>
          </h4>
<p id="section-6.5.3-1">A DTLS/SCTP implementation supporting this document MUST include the
dtls_sctp_ext extension in all DTLS Client Hello used in DTLS/SCTP
according to RFC 6083. A DTLS/SCTP implementation supporting this
document MUST abort the SCTP association if the dtls_sctp_ext
extension is received when DTLS/SCTP according to RFC 6083 is
used. This mechanism provides authenticated fallback to RFC 6083.<a href="#section-6.5.3-1" class="pilcrow">¶</a></p>
<p id="section-6.5.3-2">The dtls_sctp_ext extention is defined as follows:<a href="#section-6.5.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.5.3-3">
<pre>
enum {
    dtls_sctp_ext(TBD2), (65535)
} ExtensionType;
</pre><a href="#section-6.5.3-3" class="pilcrow">¶</a>
</div>
<p id="section-6.5.3-4">Clients MAY send this extention in ClientHello. It contains the
following structure:<a href="#section-6.5.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.5.3-5">
<pre>
struct {
    Empty;
} DTLSOverSCTPExt;
</pre><a href="#section-6.5.3-5" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="api-considerations">
<section id="section-7">
      <h2 id="name-sctp-api-consideration">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-sctp-api-consideration" class="section-name selfRef">SCTP API Consideration</a>
      </h2>
<p id="section-7-1">DTLS/SCTP needs certain functionality on the API that the SCTP
   implementation provides to the ULP to function optimally. A
   DTLS/SCTP implementation will need to provide its own API to the
   ULP, while itself using the SCTP API. This discussion is focused on
   the needed functionality on the SCTP API.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">The following functionality is needed:<a href="#section-7-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-3.1">
          <p id="section-7-3.1.1">Controlling SCTP-AUTH negotiation so that SHA-256 algorithm is
included, and determine that SHA-1 is not selected when the
association is established.<a href="#section-7-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-3.2">
          <p id="section-7-3.2.1">Determining when all SCTP packets that uses an SCTP-AUTH key or
contains DTLS records associated to a particular DTLS connection
has been acknowledged non-renegable.<a href="#section-7-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-3.3">
          <p id="section-7-3.3.1">Install SCTP-AUTH keys with directionality<a href="#section-7-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-3.4">
          <p id="section-7-3.4.1">Determining when all SCTP packets have been acknowledged
non-renegable.<a href="#section-7-3.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-3.5">
          <p id="section-7-3.5.1">Negotiating the adaptation layer indication that indicates
DTLS/SCTP and determine if it was agreed or not.<a href="#section-7-3.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-3.6">
          <p id="section-7-3.6.1">Partial user messages transmission and reception.<a href="#section-7-3.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="IANA-Consideration">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document registers a number of protocol values per the
below. RFC-Editor Note: Please replace [RFC-TBD] with the RFC number
given to this specification.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="transport-layer-security-tls-extensions">
<section id="section-8.1">
        <h3 id="name-transport-layer-security-tl">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-transport-layer-security-tl" class="section-name selfRef">Transport Layer Security (TLS) Extensions</a>
        </h3>
<p id="section-8.1-1">IANA is requested to add a value to the Transport Layer Security
   (TLS) Extensions' "TLS ExtensionType Values" registry defined by
   <span>[<a href="#RFC8447" class="cite xref">RFC8447</a>]</span>.  At time of writing located at:
   <a href="https://www.iana.org/assignments/tls-extensiontype-values/tls-extensiontype-values.xhtml#tls-extensiontype-values-1">TLS ExtensionType Values Registry</a><a href="#section-8.1-1" class="pilcrow">¶</a></p>
<span id="name-tls-extension"></span><div id="iana-TLS-extension">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-tls-extension" class="selfRef">TLS Extension</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Extension Name</th>
              <th class="text-left" rowspan="1" colspan="1">TLS 1.3</th>
              <th class="text-left" rowspan="1" colspan="1">DTLS-OK</th>
              <th class="text-left" rowspan="1" colspan="1">Recommended</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD2</td>
              <td class="text-left" rowspan="1" colspan="1">dtls_sctp_ext</td>
              <td class="text-left" rowspan="1" colspan="1">CH</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">[RFC-TBD]</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="tls-exporter-labels">
<section id="section-8.2">
        <h3 id="name-tls-exporter-labels">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-tls-exporter-labels" class="section-name selfRef">TLS Exporter Labels</a>
        </h3>
<p id="section-8.2-1">IANA is requested to add two values to the TLS Exporter Label
   registry as defined by <span>[<a href="#RFC5705" class="cite xref">RFC5705</a>]</span>, and <span>[<a href="#RFC8447" class="cite xref">RFC8447</a>]</span>. At time of
   writing located at: <a href="https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#exporter-labels">TLS Exporter Label
   registry</a><a href="#section-8.2-1" class="pilcrow">¶</a></p>
<span id="name-tls-exporter-label"></span><div id="iana-TLS">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-tls-exporter-label" class="selfRef">TLS Exporter Label</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">DTLS-OK</th>
              <th class="text-left" rowspan="1" colspan="1">Recommended</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">EXPORTER-DTLS-OVER-SCTP-CLIENT-WRITE</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">[RFC-TBD]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">EXPORTER-DTLS-OVER-SCTP-SERVER-WRITE</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">[RFC-TBD]</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sec-IANA-ACP">
<section id="section-8.3">
        <h3 id="name-sctp-adaptation-layer-indic">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-sctp-adaptation-layer-indic" class="section-name selfRef">SCTP Adaptation Layer Indication Code Point</a>
        </h3>
<p id="section-8.3-1">IANA is requested to assign an Adaptation Code Point to DTLS/SCTP
   for usage in the Adaptation Layer Indication Parameter. The
   Adaptation Code Point is registered in the SCTP Adaptation Code
   Points registry defined by <span>[<a href="#RFC5061" class="cite xref">RFC5061</a>]</span>. The registry was at time of
   writing located: <a href="https://www.iana.org/assignments/sctp-parameters/sctp-parameters.xhtml#sctp-parameters-27">Adaptation Code Point
   registry</a><a href="#section-8.3-1" class="pilcrow">¶</a></p>
<span id="name-adaptation-code-point"></span><div id="iana-ACP">
<table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-adaptation-code-point" class="selfRef">Adaptation Code Point</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Code Point (32-bit number)</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">DTLS/SCTP</td>
              <td class="text-left" rowspan="1" colspan="1">[RFC-TBD]</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sec-IANA-PPID">
<section id="section-8.4">
        <h3 id="name-sctp-payload-protocol-ident">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-sctp-payload-protocol-ident" class="section-name selfRef">SCTP Payload Protocol Identifiers</a>
        </h3>
<p id="section-8.4-1">IANA is requested to assign one SCTP Payload Protocol Identifier
   (PPID) to be used to identify the DTLS/SCTP control messages
   (<a href="#Control-Message" class="auto internal xref">Section 5</a>). This PPID is registered in the SCTP Payload
   Protocol Identifiers registry defined by <span>[<a href="#RFC9260" class="cite xref">RFC9260</a>]</span>.  The registry
   was at time of writing located: <a href="https://www.iana.org/assignments/sctp-parameters/sctp-parameters.xhtml#sctp-parameters-25">SCTP Payload Protocol
   Identifiers</a><a href="#section-8.4-1" class="pilcrow">¶</a></p>
<span id="name-sctp-payload-protocol-identi"></span><div id="iana-PPID">
<table class="center" id="table-4">
          <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-sctp-payload-protocol-identi" class="selfRef">SCTP Payload Protocol Identifier</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">SCTP PPID</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD1</td>
              <td class="text-left" rowspan="1" colspan="1">DTLS/SCTP Control Message</td>
              <td class="text-left" rowspan="1" colspan="1">[RFC-TBD]</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<div id="sec-Consideration">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-9-1">The security considerations given in <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>,
   <span>[<a href="#RFC4895" class="cite xref">RFC4895</a>]</span>, and <span>[<a href="#RFC9260" class="cite xref">RFC9260</a>]</span> also apply to this document.<a href="#section-9-1" class="pilcrow">¶</a></p>
<div id="cryptographic-considerations">
<section id="section-9.1">
        <h3 id="name-cryptographic-consideration">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-cryptographic-consideration" class="section-name selfRef">Cryptographic Considerations</a>
        </h3>
<p id="section-9.1-1">Over the years, there have been several serious attacks on earlier
   versions of Transport Layer Security (TLS), including attacks on
   its most commonly used ciphers and modes of operation.  <span>[<a href="#RFC7457" class="cite xref">RFC7457</a>]</span>
   summarizes the attacks that were known at the time of publishing
   and BCP 195 <span>[<a href="#RFC7525" class="cite xref">RFC7525</a>]</span> <span>[<a href="#RFC8996" class="cite xref">RFC8996</a>]</span> provide recommendations for
   improving the security of deployed services that use TLS.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">When DTLS/SCTP is used with DTLS 1.2 <span>[<a href="#RFC6347" class="cite xref">RFC6347</a>]</span>, DTLS 1.2 MUST be
   configured to disable options known to provide insufficient
   security. HTTP/2 <span>[<a href="#RFC9113" class="cite xref">RFC9113</a>]</span> gives good minimum requirements based
   on the attacks that where publicly known in 2022. DTLS 1.3
   <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span> only defines strong algorithms without major
   weaknesses at the time of publication. Many of the TLS registries
   have a "Recommended" column. Parameters not marked as "Y" are NOT
   RECOMMENDED to support. DTLS 1.3 is preferred over DTLS 1.2 being a
   newer protocol that addresses known vulnerabilities and only
   defines strong algorithms without known major weaknesses at the
   time of publication.<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<p id="section-9.1-3">DTLS 1.3 requires rekeying before algorithm specific AEAD limits
   have been reached. The AEAD limits equations are equally valid for
   DTLS 1.2 and SHOULD be followed for DTLS/SCTP, but are not mandated
   by the DTLS 1.2 specification.<a href="#section-9.1-3" class="pilcrow">¶</a></p>
<p id="section-9.1-4">HMAC-SHA-256 as used in SCTP-AUTH has a very large tag length and
   very good integrity properties.  The SCTP-AUTH key can be used
   longer than the current algorithms in the TLS record layer. The
   SCTP-AUTH key is rekeyed when a new DTLS connection is set up at
   which point a new SCTP-AUTH key is derived using the TLS-Exporter.<a href="#section-9.1-4" class="pilcrow">¶</a></p>
<p id="section-9.1-5">(D)TLS 1.3 <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> discusses forward secrecy from (EC)DHE,
   Key Update, and tickets/resumption. Forward secrecy limits the
   effect of key leakage in one direction (compromise of a key at
   time T2 does not compromise some key at time T1 where T1 &lt; T2).
   Protection in the other direction (compromise at time T1 does not
   compromise keys at time T2) can be achieved by rerunning (EC)DHE.
   If a long-term authentication key has been compromised, a full
   handshake with (EC)DHE gives protection against passive
   attackers. If the resumption_master_secret has been compromised,
   a resumption handshake with (EC)DHE gives protection against passive
   attackers and a full handshake with (EC)DHE gives protection against
   active attackers. If a traffic secret has been compromised, any
   handshake with (EC)DHE gives protection against active attackers.<a href="#section-9.1-5" class="pilcrow">¶</a></p>
<p id="section-9.1-6">The document “Confidentiality in the Face of Pervasive Surveillance:
   A Threat Model and Problem Statement” <span>[<a href="#RFC7624" class="cite xref">RFC7624</a>]</span> defines key
   exfiltration as the transmission of cryptographic keying material
   for an encrypted communication from a collaborator, deliberately or
   unwittingly, to an attacker. Using the terms in RFC 7624, forward
   secrecy without rerunning (EC)DHE still allows an attacker to do
   static key exfiltration. Rerunning (EC)DHE forces and attacker to
   dynamic key exfiltration (or content exfiltration).<a href="#section-9.1-6" class="pilcrow">¶</a></p>
<p id="section-9.1-7">When using DTLS 1.3 <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>, AEAD limits and
   forward secrecy can be achieved by sending post-handshake KeyUpdate
   messages, which triggers rekeying of DTLS. Such symmetric rekeying
   gives significantly less protection against key leakage than
   re-running Diffie-Hellman as explained above.  After leakage of
   application_traffic_secret_N, an attacker can passively eavesdrop
   on all future data sent on the connection including data encrypted
   with application_traffic_secret_N+1,
   application_traffic_secret_N+2, etc. Note that Key Update does not
   update the exporter_secret.<a href="#section-9.1-7" class="pilcrow">¶</a></p>
<p id="section-9.1-8">DTLS/SCTP is in many deployments replacing IPsec. For IPsec, NIST
   (US), BSI (Germany), and ANSSI (France) recommends very frequent
   re-run of Diffie-Hellman to provide forward secrecy and
   force attackers to dynamic key extraction <span>[<a href="#RFC7624" class="cite xref">RFC7624</a>]</span>. ANSSI writes
   "It is recommended to force the periodic renewal of the keys, e.g.,
   every hour and every 100 GB of data, in order to limit the impact
   of a key compromise." <span>[<a href="#ANSSI-DAT-NT-003" class="cite xref">ANSSI-DAT-NT-003</a>]</span>.<a href="#section-9.1-8" class="pilcrow">¶</a></p>
<p id="section-9.1-9">For many DTLS/SCTP deployments the SCTP association is expected to
   have a very long lifetime of months or even years. For associations
   with such long lifetimes there is a need to frequently
   re-authenticate both client and server. TLS Certificate lifetimes
   significantly shorter than a year are common which is shorter than
   expected to be used DTLS/SCTP associations lifetimes.<a href="#section-9.1-9" class="pilcrow">¶</a></p>
<p id="section-9.1-10">SCTP-AUTH re-rekeying, periodic authentication of both endpoints,
   and frequent re-run of Diffie-Hellman to force attackers to dynamic
   key extraction is in DTLS/SCTP per this specification achieved by
   setting up new DTLS connections over the same SCTP
   association. Implementations SHOULD set up new connections
   frequently to force attackers to dynamic key
   extraction. Implementations MUST set up new connections before any
   of the certificates expire. It is RECOMMENDED that all negotiated
   and exchanged parameters are the same except for the timestamps in
   the certificates. Clients and servers MUST NOT accept a change of
   identity during the setup of a new connections, but MAY accept
   negotiation of stronger algorithms and security parameters, which
   might be motivated by new attacks.<a href="#section-9.1-10" class="pilcrow">¶</a></p>
<p id="section-9.1-11">Allowing new connections can enable denial-of-service attacks.  The
   endpoints MUST limit the number of simultaneous connections to two.
   The implementor shall take into account that an existing DTLS
   connection can only be closed after "Ready_To_Close"
   <a href="#Ready_To_Close" class="auto internal xref">Section 5.2</a> indication.<a href="#section-9.1-11" class="pilcrow">¶</a></p>
<p id="section-9.1-12">When DTLS/SCTP is used with DTLS 1.2 <span>[<a href="#RFC6347" class="cite xref">RFC6347</a>]</span>, the TLS Session
   Hash and Extended Master Secret Extension <span>[<a href="#RFC7627" class="cite xref">RFC7627</a>]</span> MUST be used
   to prevent unknown key-share attacks where an attacker establishes
   the same key on several connections. DTLS 1.3 always prevents these
   kinds of attacks. The use of SCTP-AUTH then cryptographically binds
   new connections to the old connections. This together with
   mandatory mutual authentication (on the DTLS layer) and a
   requirement to not accept new identities mitigates MITM attacks
   that have plagued renegotiation <span>[<a href="#TRISHAKE" class="cite xref">TRISHAKE</a>]</span>.<a href="#section-9.1-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="downgrade-attacks">
<section id="section-9.2">
        <h3 id="name-downgrade-attacks">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-downgrade-attacks" class="section-name selfRef">Downgrade Attacks</a>
        </h3>
<p id="section-9.2-1">A peer supporting DTLS/SCTP according to this specification,
   DTLS/SCTP according to <span>[<a href="#RFC6083" class="cite xref">RFC6083</a>]</span> and/or SCTP without DTLS may be
   vulnerable to downgrade attacks where on on-path attacker
   interferes with the protocol setup to lower or disable security. If
   possible, it is RECOMMENDED that the peers have a policy only
   allowing DTLS/SCTP according to this specification.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="targeting-dtls-messages">
<section id="section-9.3">
        <h3 id="name-targeting-dtls-messages">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-targeting-dtls-messages" class="section-name selfRef">Targeting DTLS Messages</a>
        </h3>
<p id="section-9.3-1">The DTLS handshake messages and other control messages, i.e., not
   application data can easily be identified when using DTLS 1.2 as
   their content type is not encrypted. With DTLS 1.3 there is no
   unprotected content type. However, they will be sent with an PPID
   of 0 if sent in their own SCTP user messages. <a href="#Stream-Usage" class="auto internal xref">Section 4.4</a>
   proposes a basic behavior that will still make it easily for anyone
   to detect the DTLS messages that are not protected user messages.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication-and-policy-decisions">
<section id="section-9.4">
        <h3 id="name-authentication-and-policy-d">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-authentication-and-policy-d" class="section-name selfRef">Authentication and Policy Decisions</a>
        </h3>
<p id="section-9.4-1">DTLS/SCTP MUST be mutually authenticated. Authentication is the
   process of establishing the identity of a user or system and
   verifying that the identity is valid. DTLS only provides proof of
   possession of a key.  DTLS/SCTP MUST perform identity
   authentication. It is RECOMMENDED that DTLS/SCTP is used with
   certificate-based authentication. When certificates are used the
   application using DTLS/SCTP is responsible for certificate
   policies, certificate chain validation, and identity authentication
   (HTTPS does for example match the hostname with a subjectAltName of
   type dNSName). The application using DTLS/SCTP MUST define what the
   identity is and how it is encoded and the client and server MUST
   use the same identity format.  Guidance on server certificate
   validation can be found in <span>[<a href="#RFC6125" class="cite xref">RFC6125</a>]</span>.  DTLS/SCTP enables periodic
   transfer of mutual revocation information (OSCP stapling) every
   time a new parallel connection is set up.  All security decisions
   MUST be based on the peer's authenticated identity, not on its
   transport layer identity.<a href="#section-9.4-1" class="pilcrow">¶</a></p>
<p id="section-9.4-2">It is possible to authenticate DTLS endpoints based on IP addresses
   in certificates. SCTP associations can use multiple IP addresses
   per SCTP endpoint. Therefore, it is possible that DTLS records will
   be sent from a different source IP address or to a different
   destination IP address than that originally authenticated. This is
   not a problem provided that no security decisions are made based on
   the source or destination IP addresses.<a href="#section-9.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="resumption-and-tickets">
<section id="section-9.5">
        <h3 id="name-resumption-and-tickets">
<a href="#section-9.5" class="section-number selfRef">9.5. </a><a href="#name-resumption-and-tickets" class="section-name selfRef">Resumption and Tickets</a>
        </h3>
<p id="section-9.5-1">In DTLS 1.3 any number of tickets can be issued in a connection and
   the tickets can be used for resumption as long as they are valid,
   which is up to seven days. The nodes in a resumed connection have
   the same roles (client or server) as in the connection where the
   ticket was issued. Resumption can have significant latency benefits
   for quickly restarting a broken DTLS/SCTP association. If tickets
   and resumption are used it is enough to issue a single ticket per
   connection.<a href="#section-9.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-considerations">
<section id="section-9.6">
        <h3 id="name-privacy-considerations">
<a href="#section-9.6" class="section-number selfRef">9.6. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
        </h3>
<p id="section-9.6-1"><span>[<a href="#RFC6973" class="cite xref">RFC6973</a>]</span> suggests that the privacy considerations of IETF
   protocols be documented.<a href="#section-9.6-1" class="pilcrow">¶</a></p>
<p id="section-9.6-2">For each SCTP user message, the user also provides a stream
   identifier, a flag to indicate whether the message is sent ordered
   or unordered, and a payload protocol identifier.  Although
   DTLS/SCTP provides privacy for the actual user message, the other
   three information fields are not confidentiality protected.  They
   are sent as clear text because they are part of the SCTP DATA chunk
   header.<a href="#section-9.6-2" class="pilcrow">¶</a></p>
<p id="section-9.6-3">It is RECOMMENDED that DTLS/SCTP is used with certificate-based
   authentication in DTLS 1.3 <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span> to provide identity
   protection. DTLS/SCTP MUST be used with a key exchange method
   providing forward secrecy.<a href="#section-9.6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pervasive-monitoring">
<section id="section-9.7">
        <h3 id="name-pervasive-monitoring">
<a href="#section-9.7" class="section-number selfRef">9.7. </a><a href="#name-pervasive-monitoring" class="section-name selfRef">Pervasive Monitoring</a>
        </h3>
<p id="section-9.7-1">As required by <span>[<a href="#RFC7258" class="cite xref">RFC7258</a>]</span>, work on IETF protocols needs to
   consider the effects of pervasive monitoring and mitigate them when
   possible.<a href="#section-9.7-1" class="pilcrow">¶</a></p>
<p id="section-9.7-2">Pervasive Monitoring is widespread surveillance of users.  By
   encrypting more information including user identities, DTLS 1.3
   offers much better protection against pervasive monitoring.<a href="#section-9.7-2" class="pilcrow">¶</a></p>
<p id="section-9.7-3">Massive pervasive monitoring attacks relying on key exchange
   without forward secrecy has been reported. By mandating forward
   secrecy, DTLS/SCTP effectively mitigate many forms of passive
   pervasive monitoring and limits the amount of compromised data due
   to key compromise.<a href="#section-9.7-3" class="pilcrow">¶</a></p>
<p id="section-9.7-4">An important mitigation of pervasive monitoring is to force
   attackers to do dynamic key exfiltration instead of static key
   exfiltration. Dynamic key exfiltration increases the risk of
   discovery for the attacker <span>[<a href="#RFC7624" class="cite xref">RFC7624</a>]</span>. DTLS/SCTP per this
   specification encourages implementations to frequently set up new
   DTLS connections with (EC)DHE over the same SCTP association to
   force attackers to do dynamic key exfiltration.<a href="#section-9.7-4" class="pilcrow">¶</a></p>
<p id="section-9.7-5">In addition to the privacy attacks discussed above, surveillance on
   a large scale may enable tracking of a user over a wider
   geographical area and across different access networks.  Using
   information from DTLS/SCTP together with information gathered from
   other protocols increase the risk of identifying individual users.<a href="#section-9.7-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="replay_issues">
<section id="section-9.8">
        <h3 id="name-replay-attacks">
<a href="#section-9.8" class="section-number selfRef">9.8. </a><a href="#name-replay-attacks" class="section-name selfRef">Replay attacks</a>
        </h3>
<p id="section-9.8-1">Replay attack breaks data origin authentication, data integrity
   protection, and data confidentiality. The peculiar architecture of
   rfc6083 makes hard to predict how a replay attack can get success.
   What is clear is that replay attack hasn't been considered when
   rfc6083 has been specified, making it weak from the beginning.  In
   rfc6083 the replay window is open during the lifetime of the
   SCTP-AUTH key validity and being TSN visible it's relatively easy
   to inject an old Data Chunk that passes validation.  Since DTLS
   replay protection is not used and because a single chunk is also a
   single DTLS record, the attack surface of rfc6083 is large and even
   if SCTP-AUTH will be fixed in regards to replay attack, the
   combination of SCTP-AUTH and DTLS as described in rfc6083 is not by
   architecture.<a href="#section-9.8-1" class="pilcrow">¶</a></p>
<p id="section-9.8-2">Details are described in <a href="#replay_protection" class="auto internal xref">Section 3.8</a><a href="#section-9.8-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="contributors">
<section id="section-10">
      <h2 id="name-contributors">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<p id="section-10-1">Michael Tüxen contributed as co-author to the initial versions
   this draft. Michael's contributions include:<a href="#section-10-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-2.1">
          <p id="section-10-2.1.1">The use of the Adaptation Layer Indication.<a href="#section-10-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-2.2">
          <p id="section-10-2.2.1">Many editorial improvements.<a href="#section-10-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="acknowledgments">
<section id="section-11">
      <h2 id="name-acknowledgments">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-11-1">The authors of RFC 6083 which this document is based on are
   Michael Tüxen, Eric Rescorla, and Robin Seggelmann.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">The RFC 6083 authors thanked Anna Brunstrom, Lars Eggert, Gorry
   Fairhurst, Ian Goldberg, Alfred Hoenes, Carsten Hohendorf, Stefan
   Lindskog, Daniel Mentz, and Sean Turner for their invaluable comments.<a href="#section-11-2" class="pilcrow">¶</a></p>
<p id="section-11-3">The authors of this document want to thank Daria Ivanova, Li Yan,
   and GitHub user vanrein for their contribution.<a href="#section-11-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-12">
      <h2 id="name-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-12.1">
        <h3 id="name-normative-references">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3758">[RFC3758]</dt>
        <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Ramalho, M.</span>, <span class="refAuthor">Xie, Q.</span>, <span class="refAuthor">Tuexen, M.</span>, and <span class="refAuthor">P. Conrad</span>, <span class="refTitle">"Stream Control Transmission Protocol (SCTP) Partial Reliability Extension"</span>, <span class="seriesInfo">RFC 3758</span>, <span class="seriesInfo">DOI 10.17487/RFC3758</span>, <time datetime="2004-05" class="refDate">May 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3758">https://www.rfc-editor.org/info/rfc3758</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4895">[RFC4895]</dt>
        <dd>
<span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Lei, P.</span>, and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"Authenticated Chunks for the Stream Control Transmission Protocol (SCTP)"</span>, <span class="seriesInfo">RFC 4895</span>, <span class="seriesInfo">DOI 10.17487/RFC4895</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4895">https://www.rfc-editor.org/info/rfc4895</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5061">[RFC5061]</dt>
        <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Xie, Q.</span>, <span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Maruyama, S.</span>, and <span class="refAuthor">M. Kozuka</span>, <span class="refTitle">"Stream Control Transmission Protocol (SCTP) Dynamic Address Reconfiguration"</span>, <span class="seriesInfo">RFC 5061</span>, <span class="seriesInfo">DOI 10.17487/RFC5061</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5061">https://www.rfc-editor.org/info/rfc5061</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5705">[RFC5705]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"Keying Material Exporters for Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 5705</span>, <span class="seriesInfo">DOI 10.17487/RFC5705</span>, <time datetime="2010-03" class="refDate">March 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5705">https://www.rfc-editor.org/info/rfc5705</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6347">[RFC6347]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time datetime="2012-01" class="refDate">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6347">https://www.rfc-editor.org/info/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7627">[RFC7627]</dt>
        <dd>
<span class="refAuthor">Bhargavan, K., Ed.</span>, <span class="refAuthor">Delignat-Lavaud, A.</span>, <span class="refAuthor">Pironti, A.</span>, <span class="refAuthor">Langley, A.</span>, and <span class="refAuthor">M. Ray</span>, <span class="refTitle">"Transport Layer Security (TLS) Session Hash and Extended Master Secret Extension"</span>, <span class="seriesInfo">RFC 7627</span>, <span class="seriesInfo">DOI 10.17487/RFC7627</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7627">https://www.rfc-editor.org/info/rfc7627</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8260">[RFC8260]</dt>
        <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Loreto, S.</span>, and <span class="refAuthor">R. Seggelmann</span>, <span class="refTitle">"Stream Schedulers and User Message Interleaving for the Stream Control Transmission Protocol"</span>, <span class="seriesInfo">RFC 8260</span>, <span class="seriesInfo">DOI 10.17487/RFC8260</span>, <time datetime="2017-11" class="refDate">November 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8260">https://www.rfc-editor.org/info/rfc8260</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8447">[RFC8447]</dt>
        <dd>
<span class="refAuthor">Salowey, J.</span> and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"IANA Registry Updates for TLS and DTLS"</span>, <span class="seriesInfo">RFC 8447</span>, <span class="seriesInfo">DOI 10.17487/RFC8447</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8447">https://www.rfc-editor.org/info/rfc8447</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8449">[RFC8449]</dt>
        <dd>
<span class="refAuthor">Thomson, M.</span>, <span class="refTitle">"Record Size Limit Extension for TLS"</span>, <span class="seriesInfo">RFC 8449</span>, <span class="seriesInfo">DOI 10.17487/RFC8449</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8449">https://www.rfc-editor.org/info/rfc8449</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8996">[RFC8996]</dt>
        <dd>
<span class="refAuthor">Moriarty, K.</span> and <span class="refAuthor">S. Farrell</span>, <span class="refTitle">"Deprecating TLS 1.0 and TLS 1.1"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 8996</span>, <span class="seriesInfo">DOI 10.17487/RFC8996</span>, <time datetime="2021-03" class="refDate">March 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8996">https://www.rfc-editor.org/info/rfc8996</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9113">[RFC9113]</dt>
        <dd>
<span class="refAuthor">Thomson, M., Ed.</span> and <span class="refAuthor">C. Benfield, Ed.</span>, <span class="refTitle">"HTTP/2"</span>, <span class="seriesInfo">RFC 9113</span>, <span class="seriesInfo">DOI 10.17487/RFC9113</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9113">https://www.rfc-editor.org/info/rfc9113</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9146">[RFC9146]</dt>
        <dd>
<span class="refAuthor">Rescorla, E., Ed.</span>, <span class="refAuthor">Tschofenig, H., Ed.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">A. Kraus</span>, <span class="refTitle">"Connection Identifier for DTLS 1.2"</span>, <span class="seriesInfo">RFC 9146</span>, <span class="seriesInfo">DOI 10.17487/RFC9146</span>, <time datetime="2022-03" class="refDate">March 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9146">https://www.rfc-editor.org/info/rfc9146</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9147">https://www.rfc-editor.org/info/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9260">[RFC9260]</dt>
      <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Tüxen, M.</span>, and <span class="refAuthor">K. Nielsen</span>, <span class="refTitle">"Stream Control Transmission Protocol"</span>, <span class="seriesInfo">RFC 9260</span>, <span class="seriesInfo">DOI 10.17487/RFC9260</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9260">https://www.rfc-editor.org/info/rfc9260</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-12.2">
        <h3 id="name-informative-references">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC3436">[RFC3436]</dt>
        <dd>
<span class="refAuthor">Jungmaier, A.</span>, <span class="refAuthor">Rescorla, E.</span>, and <span class="refAuthor">M. Tuexen</span>, <span class="refTitle">"Transport Layer Security over Stream Control Transmission Protocol"</span>, <span class="seriesInfo">RFC 3436</span>, <span class="seriesInfo">DOI 10.17487/RFC3436</span>, <time datetime="2002-12" class="refDate">December 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3436">https://www.rfc-editor.org/info/rfc3436</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3788">[RFC3788]</dt>
        <dd>
<span class="refAuthor">Loughney, J.</span>, <span class="refAuthor">Tuexen, M., Ed.</span>, and <span class="refAuthor">J. Pastor-Balbas</span>, <span class="refTitle">"Security Considerations for Signaling Transport (SIGTRAN) Protocols"</span>, <span class="seriesInfo">RFC 3788</span>, <span class="seriesInfo">DOI 10.17487/RFC3788</span>, <time datetime="2004-06" class="refDate">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3788">https://www.rfc-editor.org/info/rfc3788</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6083">[RFC6083]</dt>
        <dd>
<span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Seggelmann, R.</span>, and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"Datagram Transport Layer Security (DTLS) for Stream Control Transmission Protocol (SCTP)"</span>, <span class="seriesInfo">RFC 6083</span>, <span class="seriesInfo">DOI 10.17487/RFC6083</span>, <time datetime="2011-01" class="refDate">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6083">https://www.rfc-editor.org/info/rfc6083</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6125">[RFC6125]</dt>
        <dd>
<span class="refAuthor">Saint-Andre, P.</span> and <span class="refAuthor">J. Hodges</span>, <span class="refTitle">"Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 6125</span>, <span class="seriesInfo">DOI 10.17487/RFC6125</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6125">https://www.rfc-editor.org/info/rfc6125</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6458">[RFC6458]</dt>
        <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Poon, K.</span>, <span class="refAuthor">Lei, P.</span>, and <span class="refAuthor">V. Yasevich</span>, <span class="refTitle">"Sockets API Extensions for the Stream Control Transmission Protocol (SCTP)"</span>, <span class="seriesInfo">RFC 6458</span>, <span class="seriesInfo">DOI 10.17487/RFC6458</span>, <time datetime="2011-12" class="refDate">December 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6458">https://www.rfc-editor.org/info/rfc6458</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6525">[RFC6525]</dt>
        <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Tuexen, M.</span>, and <span class="refAuthor">P. Lei</span>, <span class="refTitle">"Stream Control Transmission Protocol (SCTP) Stream Reconfiguration"</span>, <span class="seriesInfo">RFC 6525</span>, <span class="seriesInfo">DOI 10.17487/RFC6525</span>, <time datetime="2012-02" class="refDate">February 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6525">https://www.rfc-editor.org/info/rfc6525</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6973">[RFC6973]</dt>
        <dd>
<span class="refAuthor">Cooper, A.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Peterson, J.</span>, <span class="refAuthor">Morris, J.</span>, <span class="refAuthor">Hansen, M.</span>, and <span class="refAuthor">R. Smith</span>, <span class="refTitle">"Privacy Considerations for Internet Protocols"</span>, <span class="seriesInfo">RFC 6973</span>, <span class="seriesInfo">DOI 10.17487/RFC6973</span>, <time datetime="2013-07" class="refDate">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6973">https://www.rfc-editor.org/info/rfc6973</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7258">[RFC7258]</dt>
        <dd>
<span class="refAuthor">Farrell, S.</span> and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Pervasive Monitoring Is an Attack"</span>, <span class="seriesInfo">BCP 188</span>, <span class="seriesInfo">RFC 7258</span>, <span class="seriesInfo">DOI 10.17487/RFC7258</span>, <time datetime="2014-05" class="refDate">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7258">https://www.rfc-editor.org/info/rfc7258</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7457">[RFC7457]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Holz, R.</span>, and <span class="refAuthor">P. Saint-Andre</span>, <span class="refTitle">"Summarizing Known Attacks on Transport Layer Security (TLS) and Datagram TLS (DTLS)"</span>, <span class="seriesInfo">RFC 7457</span>, <span class="seriesInfo">DOI 10.17487/RFC7457</span>, <time datetime="2015-02" class="refDate">February 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7457">https://www.rfc-editor.org/info/rfc7457</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7525">[RFC7525]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Holz, R.</span>, and <span class="refAuthor">P. Saint-Andre</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">RFC 7525</span>, <span class="seriesInfo">DOI 10.17487/RFC7525</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7525">https://www.rfc-editor.org/info/rfc7525</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7624">[RFC7624]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Schneier, B.</span>, <span class="refAuthor">Jennings, C.</span>, <span class="refAuthor">Hardie, T.</span>, <span class="refAuthor">Trammell, B.</span>, <span class="refAuthor">Huitema, C.</span>, and <span class="refAuthor">D. Borkmann</span>, <span class="refTitle">"Confidentiality in the Face of Pervasive Surveillance: A Threat Model and Problem Statement"</span>, <span class="seriesInfo">RFC 7624</span>, <span class="seriesInfo">DOI 10.17487/RFC7624</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7624">https://www.rfc-editor.org/info/rfc7624</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ANSSI-DAT-NT-003">[ANSSI-DAT-NT-003]</dt>
        <dd>
<span class="refAuthor">Agence nationale de la sécurité des systèmes d'information</span>, <span class="refTitle">"Recommendations for securing networks with IPsec"</span>, <span class="seriesInfo">ANSSI Technical Report DAT-NT-003 </span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="&lt;https://www.ssi.gouv.fr/uploads/2015/09/NT_IPsec_EN.pdf&gt;">&lt;https://www.ssi.gouv.fr/uploads/2015/09/NT_IPsec_EN.pdf&gt;</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TRISHAKE">[TRISHAKE]</dt>
      <dd>
<span class="refAuthor">Bhargavan, K.</span>, <span class="refAuthor">Delignat-Lavaud, A.</span>, <span class="refAuthor">Fournet, C.</span>, <span class="refAuthor">Pironti, A.</span>, and <span class="refAuthor">P. Strub</span>, <span class="refTitle">"Triple Handshakes and Cookie Cutters: Breaking and Fixing Authentication over TLS"</span>, <span class="seriesInfo">IEEE Symposium on Security &amp; Privacy </span>, <time datetime="2016-04" class="refDate">April 2016</time>, <span>&lt;<a href="https://hal.inria.fr/hal-01102259/file/triple-handshakes-and-cookie-cutters-oakland14.pdf">https://hal.inria.fr/hal-01102259/file/triple-handshakes-and-cookie-cutters-oakland14.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="motivation-for-changes">
<section id="appendix-A">
      <h2 id="name-motivation-for-changes">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-motivation-for-changes" class="section-name selfRef">Motivation for Changes</a>
      </h2>
<p id="appendix-A-1">This document proposes a number of changes to RFC 6083 that have
various different motivations:<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">Supporting Large User Messages: RFC 6083 allowed only user messages
   that could fit within a single DTLS record. 3GPP has run into this
   limitation where they have at least four SCTP using protocols (F1,
   E1, Xn, NG-C) that can potentially generate messages over the size
   of 16384 bytes.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<p id="appendix-A-3">New Versions: 10 years has passed since RFC 6083 was written, and
   significant evolution has happened in the area of DTLS and security
   algorithms. Thus, DTLS 1.3 is the newest version of DTLS and also
   the SHA-1 HMAC algorithm of RFC 4895 is getting towards the end of
   usefulness. Use of DTLS 1.3 with long lived associations require a
   solution to enable mutual re-authentication and (EC)DHE based
   rekeying to ensure forward secrecy. Thus, this document mandates
   usage of relevant versions and algorithms as well as defining the
   parallel DTLS connection solution.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<p id="appendix-A-4">Allowing DTLS Messages on any stream: RFC6083 requires DTLS messages
   that are not user message data to be sent on stream 0 and that this
   stream is used with in-order delivery. That can actually limit the
   applications that can use DTLS/SCTP. In addition, with DTLS 1.3
   encrypting the actual message type it is anyway not available.
   Therefore, a more flexible rule set is used that relies on DTLS
   handling reordering.<a href="#appendix-A-4" class="pilcrow">¶</a></p>
<p id="appendix-A-5">Clarifications: Some implementation experiences have been gained that
   motivates additional clarifications on the specification.<a href="#appendix-A-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-6.1">
          <p id="appendix-A-6.1.1">Avoid unsecured messages prior to DTLS handshake have completed.<a href="#appendix-A-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-6.2">
          <p id="appendix-A-6.2.1">Make clear that all messages are encrypted after DTLS handshake.<a href="#appendix-A-6.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Magnus Westerlund</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:magnus.westerlund@ericsson.com" class="email">magnus.westerlund@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John Preuß Mattsson</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:john.mattsson@ericsson.com" class="email">john.mattsson@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Claudio Porfiri</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:claudio.porfiri@ericsson.com" class="email">claudio.porfiri@ericsson.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
